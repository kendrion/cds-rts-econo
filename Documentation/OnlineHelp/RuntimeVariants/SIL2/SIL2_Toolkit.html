

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>3.3.1. SIL2 Runtime Toolkit (SDK) &#8212; RuntimeSystemDocumentation V3.5.16.40</title>
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/theme.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="3.3.2. CODESYS Safety SIL2 Platform Support Package (PSP)" href="SIL2_PlatformSupportPackage.html" />
    <link rel="prev" title="3.3. Runtime Toolkit Embedded SIL2" href="index.html" /> 
  </head><body>
	<div id="header">
		<a href="#" title="CODESYS" target="_top" id="logo"><img src="../../_static/logo.png" width="134" height="130" alt=""></a>
		<a href="#" title="CODESYS Documentation" target="_top" id="logo-store"><img src="../../_static/logo2.png" width="137" height="130" alt=""></a>
	</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="SIL2_PlatformSupportPackage.html" title="3.3.2. CODESYS Safety SIL2 Platform Support Package (PSP)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="3.3. Runtime Toolkit Embedded SIL2"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">RuntimeSystemDocumentation V3.5.16.40</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >3. Runtime Variants</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">3.3. Runtime Toolkit Embedded SIL2</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">3.3. Runtime Toolkit Embedded SIL2</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="SIL2_PlatformSupportPackage.html"
                        title="next chapter">3.3.2. CODESYS Safety SIL2 Platform Support Package (PSP)</a></p>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="sil2-runtime-toolkit-sdk">
<span id="codesyscontrolv3-runtimevariants-sil2-toolkit"></span><h1>3.3.1. SIL2 Runtime Toolkit (SDK)<a class="headerlink" href="#sil2-runtime-toolkit-sdk" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#getting-started" id="id1">Getting Started</a></p></li>
<li><p><a class="reference internal" href="#runtime-configuration" id="id2">Runtime Configuration</a></p></li>
<li><p><a class="reference internal" href="#list-of-safe-functions" id="id3">List of safe functions</a></p></li>
<li><p><a class="reference internal" href="#adding-safe-and-non-safe-io-drivers" id="id4">Adding safe and non-safe IO-drivers</a></p>
<ul>
<li><p><a class="reference internal" href="#list-of-safe-i-o-drivers" id="id5">List of safe I/O-drivers</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="getting-started">
<h2><a class="toc-backref" href="#id1">3.3.1.1. Getting Started</a><a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>CODESYS Safety SIL2 is based on the embedded runtime of CODESYS. The safety
manuals, which are delivered as part of the toolkit, are covering mainly
the safety measures and safety requirements. The functional aspect, which
is necessary while porting the runtime is not described there.</p>
<p>The basic porting of the runtime system is exactly the same as for an embedded
system. The only difference is, that you are bound to a specific configuration,
and that you need to implement a few things differently. The following
chapter describes exactly those differences.</p>
</div>
<div class="section" id="runtime-configuration">
<h2><a class="toc-backref" href="#id2">3.3.1.2. Runtime Configuration</a><a class="headerlink" href="#runtime-configuration" title="Permalink to this headline">¶</a></h2>
<p>With CODESYS Safety SIL2 you are not fully free in the selection of your runtime
components. You need to choose the certified variants of all components, which
are involved in executing the IEC application.</p>
<p>The following components need to be choosen, despite there might be other variants,
which can be used in standard runtimes:</p>
<ul class="simple">
<li><p>CmpAppEmbedded</p></li>
<li><p>CmpScheduleTimer</p></li>
<li><p>CmpSIL2</p></li>
</ul>
<p>The selection of those components might give you additional dependencies, which
you need to fulfill. For example:</p>
<ul class="simple">
<li><p>SysTimer</p></li>
<li><p>SysInt</p></li>
<li><p>SysFlash</p></li>
<li><p>…</p></li>
</ul>
<p>For a full Safety SIL2 configuration, you also need to respect a few defines, which
will make your runtime configuration a bit more strict. For a full list, please have
a look into the Safety SIL2 manual.</p>
<ul class="simple">
<li><p>RTS_SIL2</p></li>
<li><p>RTS_COMPACT</p></li>
</ul>
<p>If you haven’t done an adaptation of CmpScheduleTimer before, you will need to
implement a few macros, which are necessary to handle the IEC task contexts. Again,
please refer to the Safety SIL2 manual for a full list.</p>
<ul class="simple">
<li><p>RTS_CPU_CONTEXT_BUFFER: Defines a context buffer structure similar to ‘jmpbuf’ for
setjmp / longjmp.</p></li>
<li><p>RTS_CPU_CALL_ON_STACK: Call a function, but switch to a new stack before.</p></li>
<li><p>RTS_CPU_GET_STACK_BASE: Calculate the initial base address of a stack.</p></li>
<li><p>RTS_CPU_STORE_CONTEXT: Save the current context similar to ‘setjmp’.</p></li>
<li><p>RTS_CPU_RESTORE_CONTEXT: Restore a previously saved context, similar to ‘longjmp’.</p></li>
<li><p>RTS_CPU_RESTORE_CONTEXT_EXCEPTION: Same as RTS_CPU_RESTORE_CONTEXT(), but recover
from an exception or trap.</p></li>
</ul>
</div>
<div class="section" id="list-of-safe-functions">
<h2><a class="toc-backref" href="#id3">3.3.1.3. List of safe functions</a><a class="headerlink" href="#list-of-safe-functions" title="Permalink to this headline">¶</a></h2>
<p>All functions, which can be used in a Safety SIL2 IEC application, need to be listed
in the macro ‘SIL2_EXTERNAL_FUNCTIONS’. This list can be extended by defining your
own external functions in ‘SIL2_ADDITIONAL_EXTERNAL_FUNCTIONS’.</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp">#define SIL2_ADDITIONAL_EXTERNAL_FUNCTIONS \</span>
<span class="cp">       {(RTS_VOID_FCTPTR)mySafeFunc1, &quot;mySafeFunc1&quot;}, \</span>
<span class="cp">       {(RTS_VOID_FCTPTR)mySafeFunc2, &quot;mySafeFunc2&quot;}, \</span>
<span class="cp">       {(RTS_VOID_FCTPTR)mySafeFunc3, &quot;mySafeFunc3&quot;}, \</span>
<span class="cp">       ...</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-safe-and-non-safe-io-drivers">
<h2><a class="toc-backref" href="#id4">3.3.1.4. Adding safe and non-safe IO-drivers</a><a class="headerlink" href="#adding-safe-and-non-safe-io-drivers" title="Permalink to this headline">¶</a></h2>
<p>The runtime component IoDrvUnsafeBridge manages all I/O-driver components of the runtime.
All safety relevant I/O-drivers have to be registered in a list of safe I/O-drivers.
These I/O-drivers are directly called by the runtime in safe context and not via component IoDrvUnsafeBridge.
All safety relevant data of safe I/O-drivers shall be placed in safety relevant and MPU protected memory.
Therefore the safety relevant data must be marked with RTS_SIL2_ATTRIBUTE.
All non-safe I/O-drivers are called by the component IoDrvUnsafeBridge and are working on a copy of the I/O configuration placed in non-safe memory.</p>
<div class="section" id="list-of-safe-i-o-drivers">
<h3><a class="toc-backref" href="#id5">List of safe I/O-drivers</a><a class="headerlink" href="#list-of-safe-i-o-drivers" title="Permalink to this headline">¶</a></h3>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cp">#define SUPPORTED_SAFE_IODRIVERS_LIST \</span>
<span class="cp">        CT_CANOPEN_SAFETY, \</span>
<span class="cp">             0</span>
       <span class="p">...</span>
</pre></div>
</div>
<p>This list contains by default all certified I/O drivers supported by 3S.
The list can be modified by the OEM. None of the drivers listed here are handled by the IoDrvUnsafeBridge component.
Note: if the IoDrvUnsafeBridge component is absent from the system, this define is ineffective and all drivers are regarded as safe.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="SIL2_PlatformSupportPackage.html" title="3.3.2. CODESYS Safety SIL2 Platform Support Package (PSP)"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="3.3. Runtime Toolkit Embedded SIL2"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">RuntimeSystemDocumentation V3.5.16.40</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >3. Runtime Variants</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >3.3. Runtime Toolkit Embedded SIL2</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, 3S-Smart Software Solutions GmbH. This document is confidential. Unauthorized copying, disclosure or distribution of this document and the information contained herein is strictly forbidden.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>