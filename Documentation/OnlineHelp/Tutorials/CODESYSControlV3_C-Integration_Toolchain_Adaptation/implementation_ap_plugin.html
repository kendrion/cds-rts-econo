

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>6.3.9.2. Implementation of an AP Plug-In for building C modules &#8212; RuntimeSystemDocumentation V3.5.16.40</title>
    <link rel="stylesheet" href="../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/theme.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="6.3.9.3. Runtime system SDK" href="runtime_system_sdk.html" />
    <link rel="prev" title="6.3.9.1. Enabling C Integration" href="enabling_c_integration.html" /> 
  </head><body>
	<div id="header">
		<a href="#" title="CODESYS" target="_top" id="logo"><img src="../../_static/logo.png" width="134" height="130" alt=""></a>
		<a href="#" title="CODESYS Documentation" target="_top" id="logo-store"><img src="../../_static/logo2.png" width="137" height="130" alt=""></a>
	</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="runtime_system_sdk.html" title="6.3.9.3. Runtime system SDK"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="enabling_c_integration.html" title="6.3.9.1. Enabling C Integration"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">RuntimeSystemDocumentation V3.5.16.40</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >6. Tutorials / HowTos</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U">6.3.9. C Integration Tutorial</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h4>Previous topic</h4>
  <p class="topless"><a href="enabling_c_integration.html"
                        title="previous chapter">6.3.9.1. Enabling C Integration</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="runtime_system_sdk.html"
                        title="next chapter">6.3.9.3. Runtime system SDK</a></p>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="implementation-of-an-ap-plug-in-for-building-c-modules">
<span id="implementation-ap-plugin"></span><h1>6.3.9.2. Implementation of an AP Plug-In for building C modules<a class="headerlink" href="#implementation-of-an-ap-plug-in-for-building-c-modules" title="Permalink to this headline">¶</a></h1>
<p>A Plug-In able to build a C module for a certain device needs to
implement specific interfaces. They can be found in the interface
Plug-In +CSourceComponentBuilder.</p>
<p>The most important interface is the ICSourceComponentBuilder. An
instance of the class implementing this interface will be created for a
build process.</p>
<p>The build progresses in the following order:</p>
<ol class="arabic simple">
<li><p>An Instance of ICSourceComponentBuilder is created and the Configure
method is called</p></li>
<li><p>A temporary directory on the filesystem will be created</p></li>
<li><p>All sources from the project are exported into that folder</p></li>
<li><p>The method ICSourceComponentBuilder.CreateDynamicObject is called</p></li>
</ol>
<div class="section" id="creation-of-a-csourcecomponentbuilder-instance">
<h2>Creation of a CSourceComponentBuilder instance<a class="headerlink" href="#creation-of-a-csourcecomponentbuilder-instance" title="Permalink to this headline">¶</a></h2>
<p>Every PlugIn providing an implementation of an ICSourceComponentBuilder
also needs to provide a factory implementing the interface
ICSourceComponentBuilderFactory.</p>
<p>When an instance of the component builder needs to be created, each
factory available will be asked if it supports a given device (calling
of the method <strong>AcceptsDevice</strong>). If the factory returns true, the
<strong>Create</strong> method will be called to receive an initialized instance.</p>
</div>
<div class="section" id="description-of-the-methods-in-icsourcecomponentbuilder">
<h2>Description of the methods in ICSourceComponentBuilder<a class="headerlink" href="#description-of-the-methods-in-icsourcecomponentbuilder" title="Permalink to this headline">¶</a></h2>
<div class="section" id="configure">
<h3>Configure<a class="headerlink" href="#configure" title="Permalink to this headline">¶</a></h3>
<p>This method is passed an instance of IBuildConfigurator as parameter.
That interface contains all relevant information necessary to setup a
build. For example it contains a list of all source and headers files
part of this C module. It also contains any additional configuration
like include and library paths.</p>
<p>This method should be used to set additional paths and defines in the
IBuildConfiguration instance which are specific to the build process for
the given device. The remaining steps in the build process will then be
able to make use of this information.</p>
</div>
<div class="section" id="createdynamicobject">
<h3>CreateDynamicObject<a class="headerlink" href="#createdynamicobject" title="Permalink to this headline">¶</a></h3>
<p>This method executes the build itsself. If the build is successfull, it
returns the created dynamic object to CODESYS. Any build or project
files (e.g. Makefiles) required for the build process are also created
in this method.</p>
<p>The build action should output meaningfull information and errors to the
users. For this it can use the event ShowBuildMessage. CODESYS
subscribes to this event and will store and output all information
passed through this event in the message window.</p>
<p><strong>Note:</strong> It is up to the Plug-In to do the filtering of its messages.</p>
</div>
<div class="section" id="property-buildconfig">
<h3>Property BuildConfig<a class="headerlink" href="#property-buildconfig" title="Permalink to this headline">¶</a></h3>
<p>The Plug-In does not only receive build information from CODESYS through
the interface IBuildConfigurator, but does also provide information to
CODESYS through the interface IBuildConfiguration. An example of such an
information ist the location of the temporary build folder.</p>
<p>An important part of the interface is the dictionary
<strong>DatatypeMapping</strong>. This dictionary is used by CODESYS when scanning a
C header file for functions and datatypes to export.</p>
<p>In contrast to IEC the actual sizes of datatypes are compiler dependant
in C. So the mapping of basic C datatypes, like integer or float, to a
corresponding IEC datatype depends on the compiler used later on to
create the dynamic module. Therefore only the device specific Plug-In
for building the C module can provide a correct mapping of C to IEC
datatypes.</p>
<p>The key of the dictionary is a C datatype as defined in the enum
TypeClassC. The value returned by the dictionary is a value from the
enum TypeClass defined in the core LanguageModel interface in CODESYS.</p>
</div>
<div class="section" id="openprojectinide">
<h3>OpenProjectInIDE<a class="headerlink" href="#openprojectinide" title="Permalink to this headline">¶</a></h3>
<p>Since CODESYS does not provide any advanced editing features for C
sources it provides the possibility to open a C module in a dedicated
external IDE.</p>
<p>If a user calls the corresponding command, CODESYS will create an
instance of the ICSourceComponentBuilder and call this method. Before
doing that, it will check the property <strong>IDESupported.</strong> If that
property returns false the user is informed that this feature is not
supported and no further actions are executed.</p>
<p>It is important that the IDE is opened non-blocking in a new process.
CODESYS can then be informed through the event IDEClosed that the user
finished editing the module outside of CODESYS. The C sources will then
be checked and updated inside the project, if necessary.</p>
</div>
</div>
<div class="section" id="environment-specific-settings">
<h2>Environment specific settings<a class="headerlink" href="#environment-specific-settings" title="Permalink to this headline">¶</a></h2>
<p>If the Plug-In for building the C module requires settings or
configurations of any kind it is free to provide the required dialogs
and checks itself through the usual means in CODESYS. The interfaces for
the C Integration do not provide any additional means for this.</p>
</div>
<div class="section" id="error-handling">
<h2>Error handling<a class="headerlink" href="#error-handling" title="Permalink to this headline">¶</a></h2>
<p>The handling of errors is generally up to the Plug-In. Build errors
(e.g. compile errors) can be output through the mechanism for build
messages. More urgent or fatal errors can also be displayed through the
MessageService of CODESYS as popups.</p>
<p>Aborting the build when detecting fatal errors in SetupBuild or
CreateDynamicObject can be done by throwing Exceptions. Every exception
will be catched by CODESYS and lead to the abortion of the build
process.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="runtime_system_sdk.html" title="6.3.9.3. Runtime system SDK"
             >next</a> |</li>
        <li class="right" >
          <a href="enabling_c_integration.html" title="6.3.9.1. Enabling C Integration"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">RuntimeSystemDocumentation V3.5.16.40</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >6. Tutorials / HowTos</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" >6.3.9. C Integration Tutorial</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, 3S-Smart Software Solutions GmbH. This document is confidential. Unauthorized copying, disclosure or distribution of this document and the information contained herein is strictly forbidden.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>