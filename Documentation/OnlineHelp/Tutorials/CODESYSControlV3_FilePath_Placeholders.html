

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>6.3.2. CODESYS Control Filepath &amp; Placeholders &#8212; RuntimeSystemDocumentation V3.5.16.40</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/theme.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.3.3. Symbolic IEC Variable Access" href="CODESYSControlV3_SymbolicAccess.html" />
    <link rel="prev" title="6.3.1.3. CmpScheduleEmbedded" href="CODESYSControlV3_Scheduler/cmpscheduleembedded.html" /> 
  </head><body>
	<div id="header">
		<a href="#" title="CODESYS" target="_top" id="logo"><img src="../_static/logo.png" width="134" height="130" alt=""></a>
		<a href="#" title="CODESYS Documentation" target="_top" id="logo-store"><img src="../_static/logo2.png" width="137" height="130" alt=""></a>
	</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="CODESYSControlV3_SymbolicAccess.html" title="6.3.3. Symbolic IEC Variable Access"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="CODESYSControlV3_Scheduler/cmpscheduleembedded.html" title="6.3.1.3. CmpScheduleEmbedded"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">RuntimeSystemDocumentation V3.5.16.40</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">6. Tutorials / HowTos</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h4>Previous topic</h4>
  <p class="topless"><a href="CODESYSControlV3_Scheduler/cmpscheduleembedded.html"
                        title="previous chapter">6.3.1.3. CmpScheduleEmbedded</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="CODESYSControlV3_SymbolicAccess.html"
                        title="next chapter">6.3.3. Symbolic IEC Variable Access</a></p>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="codesys-control-filepath-placeholders">
<span id="tutorial-filepath-and-placeholders"></span><h1>6.3.2. CODESYS Control Filepath &amp; Placeholders<a class="headerlink" href="#codesys-control-filepath-placeholders" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#introduction" id="id14">Introduction</a></p></li>
<li><p><a class="reference internal" href="#id1" id="id15">Use Cases</a></p></li>
<li><p><a class="reference internal" href="#security-settings" id="id16">Security Settings</a></p></li>
<li><p><a class="reference internal" href="#id5" id="id17">FAQ</a></p></li>
<li><p><a class="reference internal" href="#technical-reference" id="id18">Technical Reference</a></p></li>
<li><p><a class="reference internal" href="#id13" id="id19">Backup&amp;Restore</a></p></li>
</ul>
</div>
<div class="section" id="introduction">
<span id="filepath-placeholders-introduction"></span><h2><a class="toc-backref" href="#id14">6.3.2.1. Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Accessing files on a PLC can be done online via services and is usable in the file transfer UI within CODESYS or programmatically with methods of the PLCHandler. From an IEC program file-access-libraries are provided like CAA File or SysFile/SysDir. Components of the Runtime system usually written in C/C++ use the SysFile/SysDir interface functions.</p>
<p>In order to control the entire file access, path configurations (FilePath and Placeholders) and <a class="reference internal" href="#security-settings">Security Settings</a> are provided.</p>
<p>FilePath and Placeholders are introduced with the runtime system of CODESYS V3.5 SP8. The general intention of this feature is to group and redirect files on the PLC and completely separate them from runtime sytem kernel files.</p>
<p>With the <a class="reference internal" href="#filepath">“FilePath”</a> setting the standard path for file access of the runtime system may be changed from its default, the execution directory. Individual files without any paths can be redirected to other paths or folders with their full filename or a group of files with wildcards.
<a class="reference internal" href="#placeholders">Placeholders</a> are virtual folders to group files or to access files outside of the standard path.
In addition this feature is a requirement for the new <a class="reference internal" href="#backup-restore">Backup&amp;Restore</a> feature.</p>
<p>In the following chapter special <a class="reference internal" href="#use-cases">Use Cases</a> are discussed. Frequently asked questions are answered in the <a class="reference internal" href="#faq">FAQ</a> chapter. For further detail a <a class="reference internal" href="#technical-reference">Technical Reference</a> chapter is provided.</p>
<p>In the standard runtime system the configuration of filepaths and placeholders is done in the file “CODESYSControl.cfg” in the section [SysFile]. An empty section means that there are no filepaths but placeholders are  implicitly configured, see <a class="reference internal" href="#implicit-configuration">Implicit configuration</a>.</p>
<p>All configured paths are checked at startup of the runtime system and created if necessary, except for placeholders which are configured as <a class="reference internal" href="#volatile-option">“.Volatile”</a> or <a class="reference internal" href="#createonwrite-option">“.CreateOnWrite”</a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>You have to keep in mind that paths are handled case sensitive on all platforms. It is highly recommended to use a slash (not a backslash) as folder separator on all systems.</p>
</div>
</div>
<div class="section" id="id1">
<h2><a class="toc-backref" href="#id15">6.3.2.2. <span class="target" id="use-cases">Use Cases</span></a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="how-to-redirect-all-files-to-a-dedicated-folder-or-drive">
<h3>How to redirect all files to a dedicated folder or drive<a class="headerlink" href="#how-to-redirect-all-files-to-a-dedicated-folder-or-drive" title="Permalink to this headline">¶</a></h3>
<p>Configure the following setting to change the standard path:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">FilePath</span><span class="o">=</span><span class="s">/myfiles</span>
</pre></div>
</div>
<p>In the example all files (files that are accessed via SysFile or CAA File interface functions) are redirected to “/myfiles”. Visu files are implicitly redirected into a subdirectory of the standard path when using the old folder structure. In this case visu files are redirected to “/myfiles/visu”.</p>
</div>
<div class="section" id="how-to-redirect-application-related-files">
<h3>How to redirect application related files<a class="headerlink" href="#how-to-redirect-application-related-files" title="Permalink to this headline">¶</a></h3>
<p>Using the old flat folder structure, configure:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">FilePath.1</span><span class="o">=</span><span class="s">/myplc/myapp,  *.app, *.crc, *.ret</span>
</pre></div>
</div>
<p>With the old behavior wildcards for application related files still work with V3.5 SP8 and later. The files in the example are explicitly redirected to “/myplc/myapp”.</p>
<p>With the <a class="reference internal" href="#new-folder-structure-via-plclogicprefix">new folder structure</a> wildcards for application related files are obsolet, because these files are prefixed with the <a class="reference internal" href="#plclogicprefix-setting">PlcLogicPrefix</a>, i.e., “$PlcLogic$/&lt;application name&gt;”. With the following configuration</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">PlcLogicPrefix</span><span class="o">=</span><span class="s">1</span>
<span class="na">PlaceholderFilePath</span><span class="o">=</span><span class="s">/myplc, $PlcLogic$&quot;</span>
</pre></div>
</div>
<p>application related files are redirected to “/myplc/Application”, assuming that the application is named “Application”.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>With this configuration the whole new folder structure under “$PlcLogic$” is redirected to “/myplc”. Single subfolders like “$visu$” may be redirected to a different folder additionally, see <a class="reference internal" href="#new-folder-structure-via-plclogicprefix">New folder structure via PlcLogicPrefix</a>.</p>
</div>
</div>
<div class="section" id="how-to-use-a-combination-of-filepath-and-placeholderfilepath">
<h3>How to use a combination of “FilePath” and “PlaceholderFilePath”<a class="headerlink" href="#how-to-use-a-combination-of-filepath-and-placeholderfilepath" title="Permalink to this headline">¶</a></h3>
<p>Let’s start with the redirection of the standard path to “/myfiles” and an explicit placeholder for visu files:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">FilePath</span><span class="o">=</span><span class="s">/myfiles</span>
<span class="na">PlaceholderFilePath</span><span class="o">=</span><span class="s">visu, $visu$</span>
</pre></div>
</div>
<p>In this case we have an absolute standard path for all files and additionally a relative path (i.e., a subdirectory) “visu” for the visu files (which is the default), which resolves to “/myfiles/visu” because of the “FilePath” setting.</p>
<p>Changing the visu configuration to an absolute path looks like this:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">FilePath</span><span class="o">=</span><span class="s">/myfiles</span>
<span class="na">PlaceholderFilePath</span><span class="o">=</span><span class="s">/myvisu, $visu$</span>
</pre></div>
</div>
<p>In this case all visu files are redirected to “/myvisu” regardless of the absolute standard path for all other files.</p>
<p>Using the new folder structure with the same configuration:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">PlcLogicPrefix</span><span class="o">=</span><span class="s">1</span>
<span class="na">FilePath</span><span class="o">=</span><span class="s">/myfiles</span>
<span class="na">PlaceholderFilePath</span><span class="o">=</span><span class="s">/myvisu, $visu$</span>
</pre></div>
</div>
<p>In this case all visu files are redirected to “/myvisu” again regardless of the absolute standard path. But where all the other files go depends on their source:</p>
<ul class="simple">
<li><p>trend and alarm files will go to “/myfiles/PlcLogic/trend” and “/myfiles/PlcLogic/alarms”</p></li>
<li><p>files from IEC will go to “/myfiles/PlcLogic”</p></li>
<li><p>application related files will go to “/myfiles/PlcLogic/Application”, assuming that the application is named Application.</p></li>
</ul>
<p>On top of that using wildcards:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">PlcLogicPrefix</span><span class="o">=</span><span class="s">1</span>
<span class="na">FilePath</span><span class="o">=</span><span class="s">/myfiles</span>
<span class="na">PlaceholderFilePath</span><span class="o">=</span><span class="s">/myvisu, $visu$</span>
<span class="na">FilePath.1</span><span class="o">=</span><span class="s">texts, *.txt</span>
</pre></div>
</div>
<p>The same as above except for files that have no path and match with the “*.txt” wildcard, they are redirected to “/myfiles/texts” because of the “FilePath” setting.</p>
<p>Conclusion: With “FilePath” the whole file tree can be redirected to a dedicated folder. With “PlaceholderFilePath” one can redirect group of files, and relative filepaths or placeholders are prefixed with the “FilePath”.</p>
<p>For more information see <a class="reference internal" href="#filepath">FilePath</a>, <a class="reference internal" href="#placeholders">Placeholders</a>, <a class="reference internal" href="#plclogicprefix-setting">PlcLogicPrefix</a>,  <a class="reference internal" href="#new-folder-structure-via-plclogicprefix">New folder structure via PlcLogicPrefix</a>.</p>
</div>
<div class="section" id="how-to-include-a-removable-usb-flash-drive-or-memory-card-into-the-filetransfer-dialog">
<h3>How to include a removable USB flash drive or memory card into the filetransfer dialog<a class="headerlink" href="#how-to-include-a-removable-usb-flash-drive-or-memory-card-into-the-filetransfer-dialog" title="Permalink to this headline">¶</a></h3>
<p>Configure</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">PlaceholderFilePath.1</span><span class="o">=</span><span class="s">/mnt/USBDevice, $USBDev$</span>
<span class="na">PlaceholderFilePath.1.Volatile</span><span class="o">=</span><span class="s">1</span>
<span class="na">PlaceholderFilePath.1.View</span><span class="o">=</span><span class="s">1</span>
</pre></div>
</div>
<p>Since V3.5 SP6 the runtime system checks if this configured path exists. If it does it is displayed as “$USBDev$” placeholder in the filetransfer dialog. See placeholder option <a class="reference internal" href="#volatile-option">“.Volatile”</a> for details.</p>
</div>
<div class="section" id="how-to-access-a-file-via-placeholder-from-iec">
<h3>How to access a file via placeholder from IEC<a class="headerlink" href="#how-to-access-a-file-via-placeholder-from-iec" title="Permalink to this headline">¶</a></h3>
<p>Here is an example using the SysFile library. In IEC the ‘$’ is an escape character. To use the ‘$’ itself it has to be doubled:</p>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span>VAR
        Result : RTS_IEC_RESULT;
        hFile : RTS_IEC_HANDLE;
END_VAR

hFile := SysFileOpen(&#39;$$visu$$/test.bmp&#39;, ACCESS_MODE.AM_READ, ADR(Result));
IF (hFile &lt;&gt; RTS_INVALID_HANDLE) THEN
        SysFileClose(hFile);
END_IF
</pre></div>
</div>
<p>See <a class="reference internal" href="#placeholders">Placeholders</a> for details.</p>
</div>
<div class="section" id="how-to-redirect-the-web-visu-files-to-a-larger-storage-device">
<h3>How to redirect the (web) visu files to a larger storage device<a class="headerlink" href="#how-to-redirect-the-web-visu-files-to-a-larger-storage-device" title="Permalink to this headline">¶</a></h3>
<p>Since V3.5 SP6 a “$visu$” placeholder is provided to achieve this:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">PlaceholderFilePath.1</span><span class="o">=</span><span class="s">/mnt/larger_device/, $visu$</span>
</pre></div>
</div>
<p>but this setting is fixed, there is no possibility to change this setting on the fly or in dependency of the presence of a removable device.</p>
</div>
<div class="section" id="how-to-redirect-the-trend-data-base-files-to-a-large-and-fast-storage-device">
<h3>How to redirect the trend data base files to a large and fast storage device<a class="headerlink" href="#how-to-redirect-the-trend-data-base-files-to-a-large-and-fast-storage-device" title="Permalink to this headline">¶</a></h3>
<p>A trend data base can grow very fast to a big file. To regard this one may configure:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">PlaceholderFilePath.1</span><span class="o">=</span><span class="s">/mnt/fast_device/, $trend$</span>
</pre></div>
</div>
<p>Since V3.5 SP8 the trend data base uses the “$trend$” placeholder to access all its files. See <a class="reference internal" href="#known-placeholders">Known placeholders</a> for other predefined placeholders.</p>
</div>
<div class="section" id="how-to-redirect-the-alarms-data-base-files-to-a-secure-and-reliable-storage-device">
<h3>How to redirect the alarms data base files to a secure and reliable storage device<a class="headerlink" href="#how-to-redirect-the-alarms-data-base-files-to-a-secure-and-reliable-storage-device" title="Permalink to this headline">¶</a></h3>
<p>Configure</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">PlaceholderFilePath.1</span><span class="o">=</span><span class="s">/mnt/secure_device/, $alarms$</span>
</pre></div>
</div>
<p>Since V3.5 SP8 the alarms data base uses the “$alarms$” placeholder to access all its files. See <a class="reference internal" href="#known-placeholders">Known placeholders</a> for other predefined placeholders.</p>
</div>
<div class="section" id="filepath-3sdat">
<span id="id2"></span><h3><span class="target" id="how-to-hide-3s-dat">How to hide 3S.dat</span><a class="headerlink" href="#filepath-3sdat" title="Permalink to this headline">¶</a></h3>
<p>Configure</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">FilePath.1</span><span class="o">=</span><span class="s">/hidden_path/, 3S.dat</span>
</pre></div>
</div>
<p>Since V3.5 SP8 an extra “IecFilePath.1=/hidden_path/, 3S.dat” to correctly access “3S.dat” from IEC is not necessary any more, because “3S.dat” is now only controlled by “FilePath”. A configuration via “IecFilePath” for “3S.dat” will be ignored. See <a class="reference internal" href="#filepath-setting">“FilePath”</a> for more information.</p>
</div>
<div class="section" id="how-to-access-files-that-are-redirected-via-wildcards-in-the-filetransfer-dialog">
<h3><span class="target" id="how-to-access-files-that-are-redirected-via-wildcards">How to access files that are redirected via wildcards</span> in the filetransfer dialog<a class="headerlink" href="#how-to-access-files-that-are-redirected-via-wildcards-in-the-filetransfer-dialog" title="Permalink to this headline">¶</a></h3>
<p>There may be the following configuration:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">FilePath.1</span><span class="o">=</span><span class="s">/Temp/Wildcards, *.txw</span>
</pre></div>
</div>
<p>To access these files via filetransfer and include them in the backup configure the following placeholder:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">PlaceholderFilePath.1.View</span><span class="o">=</span><span class="s">1</span>
<span class="na">PlaceholderFilePath.1.VParent</span><span class="o">=</span><span class="s">$PlcLogic$</span>
<span class="na">PlaceholderFilePath.1</span><span class="o">=</span><span class="s">/Temp/Wildcards, $Wildcards$</span>
</pre></div>
</div>
<p>With the option <a class="reference internal" href="#view-option">“.View=1”</a> the placeholder shows up in the filetransfer dialog. With the option <a class="reference internal" href="#vparent-option">“.VParent=$PlcLogic$”</a> the placeholder shows up additionally as child of the “$PlcLogic$” placeholder.</p>
<p>Every file that is accessible via filetransfer as a child of “$PlcLogic$” can be backed up with the already implemented <a class="reference internal" href="#backup-restore">simple backup mode</a>. On the other hand, any file that is not accessible via filetransfer can not be backed up.</p>
</div>
<div class="section" id="tutorial-filepath-and-placeholders-exclude-files-from-transfer">
<span id="id3"></span><h3><span class="target" id="how-to-exclude-files-from-file-transfer-actions">How to exclude files from file(transfer) actions</span><a class="headerlink" href="#tutorial-filepath-and-placeholders-exclude-files-from-transfer" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Files and directories starting with a “.” are hidden fo the filetransfer by default (e.g. “.UserDatabase.csv” or “.GroupDatabase.csv”)!</p></li>
<li><p>Although configuration files may be viewable in the filetransfer dialog in CODEDSYS no online file accesss is possible on these files since V3.5 SP13. I.e. any read, write, delete, rename access is denied.</p></li>
<li><p>In addition, a component can blacklist a file of importance, then no online file access is possible as well.
Files can be hidden from filetransfer (see <a class="reference internal" href="#how-to-hide-3s-dat">How to hide 3S.dat</a>).</p></li>
<li><p>File access to folders outside of the standard path is denied by default (see <a class="reference internal" href="#forceonlinefilepath-setting">ForceOnlineFilePath</a>) since V3.5 SP13.
See <a class="reference internal" href="#security-settings">Security Settings</a> for more details.</p></li>
</ul>
</div>
<div class="section" id="how-to-protect-files-from-iec-access">
<h3>How to protect files from IEC access<a class="headerlink" href="#how-to-protect-files-from-iec-access" title="Permalink to this headline">¶</a></h3>
<p>A component can blacklist a file of importance, i.e. no file access from IEC is possible. File access from IEC to folders outside of the standard path may be denied with the <a class="reference internal" href="#forceiecfilepath-setting">ForceIecFilePath</a> setting.
See <a class="reference internal" href="#security-settings">Security Settings</a> for more details.</p>
</div>
</div>
<div class="section" id="security-settings">
<span id="id4"></span><h2><a class="toc-backref" href="#id16">6.3.2.3. Security Settings</a><a class="headerlink" href="#security-settings" title="Permalink to this headline">¶</a></h2>
<p>To secure file access of the PLC there are several possibilities:</p>
<ul>
<li><div class="line-block">
<div class="line"><a class="reference internal" href="#forcefilepath-setting">ForceFilePath</a>/<a class="reference internal" href="#forceiecfilepath-setting">ForceIecFilePath</a> with whitelist</div>
<div class="line">Sandbox setting for all file access or IEC only</div>
<div class="line">A whitelist is formed out of all configured paths (<a class="reference internal" href="#filepath">FilePath</a> and <a class="reference internal" href="#placeholders">Placeholders</a>).</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Blacklist (introduced with SP12)</div>
<div class="line">Components may register their files in a blacklist, i.e. access is denied from IEC and online so far (see SysFile interface description for details).</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><a class="reference internal" href="#forceonlinefilepath-setting">ForceOnlineFilePath</a> with whitelist (introduced with SP13, active by default)</div>
<div class="line">Sandbox setting for online file access only</div>
<div class="line">A whitelist is formed out of all configured paths (<a class="reference internal" href="#filepath">FilePath</a> and <a class="reference internal" href="#placeholders">Placeholders</a>).</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><a class="reference internal" href="#denyonlineaccesscfgfile-setting">DenyOnlineAccessCfgFile</a>: Explicitly deny online access to configuration files (introduced with SP13, active by default)</div>
<div class="line">The startup configuration file and all configuration file references are protected against any file access via online services</div>
</div>
</li>
</ul>
<p>Introduced with V.3.5 SP13, and accompanied with Security Advisory 2018-04, file access via online services is put into a sandbox by default (<a class="reference internal" href="#forceonlinefilepath-setting">ForceOnlineFilePath</a>). This is the same behaviour as already available with <a class="reference internal" href="#forcefilepath-setting">ForceFilePath</a> and <a class="reference internal" href="#forceiecfilepath-setting">ForceIecFilePath</a>:
File access is allowed within the configured paths (sandbox) but access with an absolut path that is not in the whitelist of configured paths or a directory-traversal path (i.e. a path that contains “..”) is denied.</p>
<p>Another security aspect for online file access is the user rights management. Individual folder access rights may be determined in the file tree of the PLC in the Access Rights tab of the Device page.
For more information see CODESYS Help Tab ‘Access Rights’.</p>
</div>
<div class="section" id="id5">
<h2><a class="toc-backref" href="#id17">6.3.2.4. <span class="target" id="faq">FAQ</span></a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<div class="section" id="how-does-the-runtime-sytem-resolve-these-new-double-placeholders">
<h3>How does the runtime sytem resolve these new double placeholders?<a class="headerlink" href="#how-does-the-runtime-sytem-resolve-these-new-double-placeholders" title="Permalink to this headline">¶</a></h3>
<p>Since V3.5 SP8 the visu files for example are accessed with a double placeholder like “$PlcLogic$/$visu$/my.svg”. The runtime system primarily resolves the first placeholder “$PlcLogic$”. With this placeholder the whole PlcLogic tree can be redirected to another place than the default: a subdirectory of the execution folder. Next the second placeholder is resolved and it replaces the former one, i.e., the last placeholder wins. In the default configuration of the new folder structure the placeholders are resolved to corresponding subdirectories, i.e., “$PlcLogic$/$visu$/my.svg” is finally resolved to “PlcLogic/visu/my.svg”.</p>
<p>With this double-stage resolving of the “$PlcLogic$/$visu$” placeholder there is the possibility to redirect just the visu files with the “$visu$” placeholder or the whole PlcLogic tree with the “$PlcLogic$” placeholder.</p>
<p>Given the following configuration:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">PlcLogicPrefix</span><span class="o">=</span><span class="s">1</span>
<span class="na">PlaceholderFilePath</span><span class="o">=</span><span class="s">/myplc, $PlcLogic$&quot;</span>
<span class="na">PlaceholderFilePath.1</span><span class="o">=</span><span class="s">/myvisu, $visu$</span>
</pre></div>
</div>
<p>In this case we have the new folder structure and the first placeholder “$PlcLogic$” is resolved to “/myplc” but the “$visu$” placeholder is resolved to “/myvisu” and this replaces the former resolve. Therefore “$PlcLogic$/$visu$/my.svg” finally resolves to “/myvisu/my.svg”.</p>
<p>Regarding now the compatibility with the old flat folder structure with the double placeholder “$PlcLogic$/$visu$/my.svg”: Primarily the first placeholder “$PlcLogic$” is resolved. But because the default configuration of the “$visu$” placeholder for the old flat folder structure is just “visu” the double placeholder is finally resolved to “visu/my.svg”.</p>
</div>
<div class="section" id="what-requirements-are-substantial-for-backup-restore">
<h3>What requirements are substantial for Backup&amp;Restore?<a class="headerlink" href="#what-requirements-are-substantial-for-backup-restore" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>First of all CODESYS and RTS must be at least of V3.5 SP8.</p></li>
<li><p>Then “PlcLogicPrefix=1” must be configured in the [SysFile] section (see <a class="reference internal" href="#plclogicprefix-setting">“PlcLogicPrefix”</a>).</p></li>
<li><p>To ensure that files that are redirected via wildcards are included in the backup, see <a class="reference internal" href="#how-to-access-files-that-are-redirected-via-wildcards">How to access files that are redirected via wildcards</a>.</p></li>
<li><p>The device description must be updated at least to V3.5.80.</p></li>
<li><p>Then there should be a new tab “Backup and Restore” in the “Device” page.</p></li>
<li><p>To “Read backup information from device” there should be at least one application on the device.</p></li>
<li><p>It is recommended to set the device to STOP especially to backup data base files in a consistent state.</p></li>
</ul>
<p>See chapter <a class="reference internal" href="#backup-restore">Backup&amp;Restore</a> for more information.</p>
</div>
<div class="section" id="how-can-i-reverse-the-implicit-setting-iecfilepath-plclogic-without-abandoning-the-new-folder-structure-by-setting-plclogicprefix-1">
<h3>How can I reverse the implicit setting “IecFilePath=$PlcLogic$” without abandoning the new folder structure by setting “PlcLogicPrefix=-1”?<a class="headerlink" href="#how-can-i-reverse-the-implicit-setting-iecfilepath-plclogic-without-abandoning-the-new-folder-structure-by-setting-plclogicprefix-1" title="Permalink to this headline">¶</a></h3>
<p>First of all a note that this undermines the Backup&amp;Restore feature for IEC files with that setting!</p>
<p>With configuring “IecFilePath=” IecFilePath is set to the standard path (“IecFilePath=,” works for this prior to CDS-46893, or V3.5 SP9 respectively).</p>
</div>
<div class="section" id="i-forgot-the-placeholder-markers-in-my-configuration-i-configured-placeholderfilepath-hi-there-what-gives">
<h3>I forgot the placeholder markers “$” in my configuration, I configured “PlaceholderFilePath=hi, there”, what gives?<a class="headerlink" href="#i-forgot-the-placeholder-markers-in-my-configuration-i-configured-placeholderfilepath-hi-there-what-gives" title="Permalink to this headline">¶</a></h3>
<p>A folder “hi” will be created. A virtual folder “there” will show up in the “Device/Files” dialog with a normal yellowish folder icon but this virtual folder is not resolved to “hi” because it is not recognized as a placeholder and therefore points into the void. Going into that folder there is not even a “..” entry to go back. By copying a file into “there” an appropriate folder is created in the standard path. Then there are two entries named “there” in the “Device/Files” dialog: the physical one and the virtual one and both they lead to the physical one now. This is probably not the intention.</p>
</div>
</div>
<div class="section" id="technical-reference">
<span id="id6"></span><h2><a class="toc-backref" href="#id18">6.3.2.5. Technical Reference</a><a class="headerlink" href="#technical-reference" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id7">
<h3><span class="target" id="filepath">FilePath</span><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>With the <a class="reference internal" href="#filepath-setting">“FilePath”</a> setting it is possible to configure the standard path of the runtime system (as known as the runtime system root directory, not to be mistaken with the root directoy of the underlying file system). Individual files without any paths can be redirected to other paths or folders with their full filename or a group of files with wildcards to meet one’s needs. This configuration can be done differently for C (“FilePath”) and IEC (“IecFilePath”) file access.</p>
<p>These settings concern files and folders that are created and accessed via SysFile/SysDir or CAA File interface functions, except the files are accessed via an absolute path.</p>
<p>If only “FilePath” is configured, file access from IEC falls back to the configuration of “FilePath”. On the other hand if “IecFilePath” is configured only, the file access from C is not affected.
When “IecFilePath” is set, there is no fallback to “Filepath” settings. In this case file access from IEC to specific files configured with FilePath is possible only when configured with IecFilePath too.
e.g.:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">FilePath</span><span class="o">=</span><span class="s">/ata0a/</span>
<span class="na">IecFilePath</span><span class="o">=</span><span class="s">/ata0b/</span>
<span class="na">FilePath.1</span><span class="o">=</span><span class="s">/ata0, test.txt</span>
<span class="na">IecFilePath.1</span><span class="o">=</span><span class="s">/ata0, test.txt</span>
</pre></div>
</div>
<p>The last line is necessary when access from IEC is desired.
An exception to this is the license file “3S.dat”. Since V3.5 SP8 or CDS-35792 respectively, this file is resolved according to “FilePath” consistent from C as well as from IEC.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Since V3.5 SP8 and with PlcLogicPrefix=1 (see <a class="reference internal" href="#plclogicprefix-setting">“PlcLogicPrefix”</a>) “IecFilePath” is implicitly set to “$PlcLogic$”!</p>
</div>
<p>With the “Force” flags file access can be forced to stay inside the configured paths (like a sandbox). All configured paths form a whitelist of allowed paths, i.e., absolute paths that are not in the whitelist and directory-traversal paths (i.e. paths that contain “..”) are prohibited then.</p>
<div class="section" id="configuration">
<h4>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h4>
<p id="filepath-setting"><strong>“FilePath”</strong></p>
<div class="line-block">
<div class="line">type=String</div>
<div class="line">Setting to configure the standard path for file access, for all filenames with no specified path or for directory access.</div>
<div class="line">The setting has the following structure:</div>
</div>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">FilePath</span><span class="o">=</span><span class="s">&lt;directory path, relative or absolute&gt;{[, filedesc]}</span>
</pre></div>
</div>
<p>A filedesc is either a filename or a wildcard to match a specific file extension, it is optional and may be repeated.</p>
<p>Several file paths could be configured, if they were indexed, e.g.:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">FilePath</span><span class="o">=</span><span class="s">/Temp/Default</span>
<span class="na">FilePath.1</span><span class="o">=</span><span class="s">./Boot, *.app, *.ap_, *.ret, *.frc</span>
<span class="na">FilePath.2</span><span class="o">=</span><span class="s">/Temp/Wildcards, *.txw</span>
<span class="na">FilePath.3</span><span class="o">=</span><span class="s">/Temp/Wildcards, File7.txt</span>
</pre></div>
</div>
<p>In this case, files with special extensions or a special name could be separated into several directories. File extensions are specified with the wildcards ‘*’.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the new folder structure is used (see <a class="reference internal" href="#new-folder-structure-via-plclogicprefix">New folder structure via PlcLogicPrefix</a>) these application related files of “FilePath.1” are now redirected to an application folder (prefixed with “$PlcLogic/&lt;application&gt;”), i.e., especially these wildcards are obsolete and won’t work any more.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A double extension like *.trace.csv hasn’t matched at no time.</p>
</div>
<p>If only a path but no file wildcard or filename is specified, the standard path for all file or directory access is configured, e.g.:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">FilePath</span><span class="o">=</span><span class="s">/Temp/Default</span>
</pre></div>
</div>
<p id="forcefilepath-setting"><strong>“ForceFilePath”</strong></p>
<div class="line-block">
<div class="line"><em>- Security setting -</em></div>
<div class="line">type=Int</div>
<div class="line">default=0</div>
<div class="line">Setting to put the PLC into a sandbox for file access, i.e. file access is only allowed inside the configured paths.</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This setting controls all file access from C, from IEC and via online services.</p>
</div>
<p>If an absolute or directory-traversal file path (i.e. a path that contains “..”) is requested and this path is not a configured path an error is returned for this operation (ERR_OPERATION_DENIED).</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">FilePath</span><span class="o">=</span><span class="s">/Data/PlcSandbox</span>
<span class="na">ForceFilePath</span><span class="o">=</span><span class="s">1</span>
</pre></div>
</div>
<p>In this configuration all file access to the PLC is allowed only inside of “/Data/PlcSandbox”.</p>
<p id="iecfilepath-setting"><strong>“IecFilePath”</strong></p>
<div class="line-block">
<div class="line">type=String</div>
<div class="line">Setting to configure the standard IEC path for file access, for all filenames with no specified path or for directory access.</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>THIS IS USED ONLY FOR ALL FILE ACCESS ROUTINES OUT OF THE IEC PROGRAM!</p>
</div>
<p>Several file paths could be configured, if they were indexed, e.g.:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">IecFilePath</span><span class="o">=</span><span class="s">/Temp/Default/IEC</span>
<span class="na">IecFilePath.1</span><span class="o">=</span><span class="s">./Boot, *.app, *.ap_, *.ret, *.frc</span>
<span class="na">IecFilePath.2</span><span class="o">=</span><span class="s">/Temp/Wildcards, *.txw</span>
<span class="na">IecFilePath.3</span><span class="o">=</span><span class="s">/Temp/Wildcards, File7.txt</span>
</pre></div>
</div>
<p>In this case, files with special extensions or a special name could be separated into several directories. File extensions can be specified with the wildcards ‘*’.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the new folder structure is used (see <a class="reference internal" href="#new-folder-structure-via-plclogicprefix">New folder structure via PlcLogicPrefix</a>) these application related files of “IecFilePath.1” are now redirected to an application folder (prefixed with “$PlcLogic/&lt;application&gt;”), i.e., especially these wildcards are obsolete and won’t work any more.</p>
</div>
<p>If only a path but no file wildcard or filename is specified, the standard path for all IEC file or directory access is configired, e.g.:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">IecFilePath</span><span class="o">=</span><span class="s">/Temp/Default/IEC</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the new folder structure is used “IecFilePath” is implicitly set to “$PlcLogic$” if not configured.</p>
</div>
<p id="forceiecfilepath-setting"><strong>“ForceIecFilePath”</strong></p>
<div class="line-block">
<div class="line"><em>- Security setting -</em></div>
<div class="line">type=Int</div>
<div class="line">default=0</div>
<div class="line">Setting to put the PLC into a sandbox for file access from IEC, i.e. file access is only allowed inside the configured paths.</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This setting controls all file access from IEC but ForceFilePath (if set) dominates this setting.</p>
</div>
<p>If an absolute or directory-traversal file path (i.e. a path that contains “..”) is requested and this path is not a configured path an error is returned for this operation (ERR_OPERATION_DENIED).</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">PlcLogicPrefix</span><span class="o">=</span><span class="s">1</span>
<span class="na">ForceIecFilePath</span><span class="o">=</span><span class="s">1</span>
</pre></div>
</div>
<p>In this configuration all file access to the PLC is allowed only inside of “$PlcLogic$”, because “IecFilePath” is implicitly set to “$PlcLogic$” when “PlcLogicPrefix=1”.</p>
<p id="forceonlinefilepath-setting"><strong>“ForceOnlineFilePath”</strong></p>
<div class="line-block">
<div class="line"><em>- Security setting -</em></div>
<div class="line">type=Int</div>
<div class="line">default=1</div>
<div class="line">Setting to put the PLC into a sandbox for online file access, i.e. file access is only allowed inside the configured paths.</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This setting controls all online file access but ForceFilePath (if set) dominates this setting.</p>
</div>
<p>If an absolute or directory-traversal file path (i.e. a path that contains “..”) is requested and this path is not a configured path an error is returned for this operation (ERR_OPERATION_DENIED).</p>
<p>To restore the old behaviour this setting may be configured as follows:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">ForceOnlineFilePath</span><span class="o">=</span><span class="s">0</span>
</pre></div>
</div>
<p>BUT WE HIGHLY RECOMMEND, TO LEAVE THIS SETTING AT ITS DEFAULT VALUE! (see Security Advisory 2018-04)</p>
<p id="denyonlineaccesscfgfile-setting"><strong>“DenyOnlineAccessCfgFile”</strong></p>
<div class="line-block">
<div class="line"><em>- Security setting -</em></div>
<div class="line">type=Int</div>
<div class="line">default=1</div>
<div class="line">Setting to deny online file access to the configuration file and all its references.</div>
<div class="line">If a configuration file is requested, an error is returned at this operation (ERR_OPERATION_DENIED).</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This setting is independent of any Force settings.</p>
</div>
<p>To restore the old behaviour this setting may be configured as follows:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">DenyOnlineAccessCfgFile</span><span class="o">=</span><span class="s">0</span>
</pre></div>
</div>
<p>BUT WE HIGHLY RECOMMEND, TO LEAVE THIS SETTING AT ITS DEFAULT VALUE! (see Security Advisory 2018-04)</p>
</div>
</div>
<div class="section" id="id8">
<h3><span class="target" id="placeholders">Placeholders</span><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>Placeholders are virtual folders to group files or to access files outside of the standard path (even if “ForceFilePath” is set). They are marked like “$Placeholder$”, i.e., the name is enclosed in “$”. This is mandatory to let the runtime system recognize the placeholder.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If a placeholder is used in a file path, its name must not contain any characters that are invalid for filenames such as slashes, backslashes, colons, asterisks, question marks and the like.</p>
</div>
<p>Placeholders are resolved to their configured paths consistent from C and IEC. If a placeholder can’t be resolved it is replaced by a folder with the placeholder’s name. E.g. “$Placeholder$/filename.ext” is replaced with “Placeholder/filename.ext” if “$Placeholder$” is not configured.</p>
<p>In IEC the ‘$’ is an escape character. To use the ‘$’ itself it has to be doubled:</p>
<div class="highlight-codesys notranslate"><div class="highlight"><pre><span></span>hFile := SysFileOpen(&#39;$$visu$$/test.bmp&#39;, ACCESS_MODE.AM_READ, ADR(Result));
</pre></div>
</div>
<div class="section" id="display-of-placeholders">
<h4>Display of placeholders<a class="headerlink" href="#display-of-placeholders" title="Permalink to this headline">¶</a></h4>
<p>In the “Device/Files” dialog (as known as filetransfer dialog) placeholders have an icon different to the normal yellowish folder icon (assuming the <a class="reference internal" href="#view-option">“.View”</a> option is set). Placeholders which lead to subdirectories inside the standard path are internally marked as redundant and their icon is a gray one. This regards to all the implicitly configured placeholders (see <a class="reference internal" href="#known-placeholders">Known placeholders</a>, <a class="reference internal" href="#implicit-configuration">Implicit configuration</a>). On the other hand placeholders which are explicitly configured and lead to a different path or even to another device have a blue icon.</p>
<p>All placeholders show up within the standard path, and if a virtual parent is configured they can be found inside their parent placeholder folder too - but not inside the corresponding physical folder. This regards to the implicitly configured placeholders for applicaton related files such as “$visu$”, “$trend$ and the like (see <a class="reference internal" href="#known-placeholders">Known placeholders</a>).</p>
<p>In the “Device/Files” dialog placeholders can’t be created, renamed or deleted. These options are disabled.</p>
<p>Independant of the <a class="reference internal" href="#view-option">“.View”</a> option while opening a placeholder folder explicitly the placeholders inside are visible. This is important for the backup of the “$PlcLogic$” folder.</p>
<p>In case the <a class="reference internal" href="#view-option">“.View”</a> option is not set, calling SysDirOpen(“”) and then SysDirRead() successively from IEC one doesn’t get the placeholders even one is redirected to “$PlcLogic$” because the opening path is not a placeholder. To view the placeholders inside “$PlcLogic$” one have to call explicitly SysDirOpen(“$$PlcLogic$$”).</p>
</div>
<div class="section" id="id9">
<h4>Configuration<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<p><strong>“PlaceholderFilePath”</strong></p>
<div class="line-block">
<div class="line">type=String</div>
<div class="line">Setting to configure a placeholder file path for file access. A placeholder is used like a relative path, but with special placeholder marks, e.g.: “$visu$/mainwindows.bmp”</div>
<div class="line">The setting has the following structure:</div>
</div>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">PlaceholderFilePath</span><span class="o">=</span><span class="s">&lt;directory path, relative or absolute&gt;, &lt;placeholder&gt;</span>
</pre></div>
</div>
<p>Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">PlaceholderFilePath</span><span class="o">=</span><span class="s">/MyPlace/, $MyPlace$</span>
</pre></div>
</div>
<p>Several file paths could be configured, if they were indexed, e.g.:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">PlaceholderFilePath.1</span><span class="o">=</span><span class="s">visu/, $visu$</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The trailing slash of the path is optional, it is added automatically.</p>
</div>
</div>
<div class="section" id="placeholder-options">
<h4>Placeholder options<a class="headerlink" href="#placeholder-options" title="Permalink to this headline">¶</a></h4>
<p id="view-option"><strong>“.View”</strong></p>
<div class="line-block">
<div class="line">type=Int</div>
<div class="line">Setting to make a single placeholder visible in the file transfer window. The default setting is 0 (invisible).</div>
<div class="line">Example:</div>
</div>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">PlaceholderFilePath</span><span class="o">=</span><span class="s">/MyPlace/, $MyPlace$</span>
<span class="na">PlaceholderFilePath.View</span><span class="o">=</span><span class="s">1</span>
</pre></div>
</div>
<p><strong>“PlaceholderFilePath.All.View”</strong></p>
<div class="line-block">
<div class="line">type=Int</div>
<div class="line">Setting to make all placeholders visible in the file transfer window at once. The default setting is 0 (invisible).</div>
<div class="line">A single placeholder can be hidden by setting its <a class="reference internal" href="#view-option">“.View”</a> option to 0.</div>
<div class="line">Example:</div>
</div>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">PlaceholderFilePath</span><span class="o">=</span><span class="s">/MyPlace/, $MyPlace$</span>
<span class="na">PlaceholderFilePath.1</span><span class="o">=</span><span class="s">visu/, $visu$</span>
<span class="na">PlaceholderFilePath.2</span><span class="o">=</span><span class="s">/Temp, $Temp$</span>
<span class="na">PlaceholderFilePath.All.View</span><span class="o">=</span><span class="s">1</span>
<span class="na">PlaceholderFilePath.2.View</span><span class="o">=</span><span class="s">0</span>
</pre></div>
</div>
<p>In this example the placeholders “$MyPlace$” and “$visu$” are visible in the file transfer window while “$Temp$” is not. But all three placeholders are accessible e.g. from IEC.</p>
<p id="volatile-option"><strong>“.Volatile”</strong></p>
<div class="line-block">
<div class="line">type=Int</div>
<div class="line">Setting to mark a placeholder as volatile, i.e., the specified folder is not created automatically at startup and the placeholder is visible in the filetransfer window only when the folder exists. The default setting is 0 (not volatile).</div>
<div class="line">This behavior is important for hot plug devices like USB flash drives. Therefore the configured path is not created on write access.</div>
<div class="line">Example:</div>
</div>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">PlaceholderFilePath.2</span><span class="o">=</span><span class="s">/mnt/USBDevice, $USBDev$</span>
<span class="na">PlaceholderFilePath.2.Volatile</span><span class="o">=</span><span class="s">1</span>
<span class="na">PlaceholderFilePath.2.View</span><span class="o">=</span><span class="s">1</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="#view-option">“.View”</a> option is not implicitly set.</p>
</div>
<p id="vparent-option"><strong>“.VParent”</strong></p>
<div class="line-block">
<div class="line">type=String</div>
<div class="line">Setting to virtually connect a placeholder with a parent placeholder, i.e., in the filetransfer window this placeholder is reachable via its virtual parent placeholder additionally.</div>
<div class="line">Example:</div>
</div>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">PlaceholderFilePath.1</span><span class="o">=</span><span class="s">/temp/oem, $oem$</span>
<span class="na">PlaceholderFilePath.1.VParent</span><span class="o">=</span><span class="s">$PlcLogic$</span>
<span class="na">PlaceholderFilePath.1.View</span><span class="o">=</span><span class="s">1</span>
</pre></div>
</div>
<p>The oem placeholder is virtually placed under “$PlcLogic$” but physically at /temp/oem.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="#view-option">“.View”</a> option is not implicitly set.</p>
</div>
<p id="createonwrite-option"><strong>“.CreateOnWrite”</strong></p>
<div class="line-block">
<div class="line">type=Int</div>
<div class="line">Setting to mark a placeholder so that the specified folder is created when a file is to be written in that folder, the  folder is not created at startup, the placeholder is visible in the filetransfer window only when the folder exists. The default setting is 0 (create at startup).</div>
<div class="line">Example:</div>
</div>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">PlaceholderFilePath.2</span><span class="o">=</span><span class="s">/Temp, $Temp$</span>
<span class="na">PlaceholderFilePath.2.CreateOnWrite</span><span class="o">=</span><span class="s">1</span>
<span class="na">PlaceholderFilePath.2.View</span><span class="o">=</span><span class="s">1</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="#view-option">“.View”</a> option is not implicitly set.</p>
</div>
</div>
<div class="section" id="id10">
<h4><span class="target" id="known-placeholders">Known placeholders</span><a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<div class="line-block">
<div class="line">“$PlcLogic$”</div>
<div class="line">“$visu$”</div>
<div class="line">“$trend$”</div>
<div class="line">“$alarms$”</div>
<div class="line">“$ac_persistence$”</div>
<div class="line">“$TBF$”</div>
<div class="line">“$_cnc$”</div>
</div>
<p>All these placeholders are configured implicitly at startup. And then they are created except “$TBF$” which has the “.CreateOnWrite” option set. Their path depends on the <a class="reference internal" href="#plclogicprefix-setting">“PlcLogicPrefix”</a> setting.</p>
</div>
<div class="section" id="id11">
<h4><span class="target" id="new-folder-structure-via-plclogicprefix">New folder structure via PlcLogicPrefix</span><a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h4>
<p id="plclogicprefix-setting"><strong>“PlcLogicPrefix”</strong></p>
<div class="line-block">
<div class="line">type=Int</div>
<div class="line">Setting to configure the plc logic placeholder prefix that is used now by all application related files.</div>
</div>
<p>-1 - old behaviour: no prefix and a flat file structure (default):</p>
<blockquote>
<div><div class="line-block">
<div class="line">[$PlcLogic$]</div>
<div class="line">[$visu$]</div>
<div class="line">[$_cnc$]</div>
<div class="line">all other known placeholders are set to the standard path</div>
</div>
</div></blockquote>
<p>0 - migration: starting with old behaviour (no prefix and a flat file structure), but “Reset Origin Device” or a startup with no bootproject will install the new folder structure and change that value to 1</p>
<p>1 - new folder structure:</p>
<blockquote>
<div><div class="line-block">
<div class="line">[$PlcLogic$]</div>
<div class="line">+ [&lt;application&gt;]</div>
<div class="line">+ [$trend$]</div>
<div class="line">+ [$alarms$]</div>
<div class="line">+ [$ac_persistence$]</div>
<div class="line">+ [$visu$]</div>
<div class="line">+ [$_cnc$]</div>
</div>
</div></blockquote>
<p>With the new folder structure …</p>
<ul>
<li><p>file access from IEC is redirected to “$PlcLogic$”. To achieve this “IecFilePath=$PlcLogic$” is implicitly set, if “IecFilePath” is not explicitly configured otherwise.</p></li>
<li><p>all application related files are prefixed with “$PlcLogic$/&lt;application&gt;”, i.e., a redirection with wildcards (see <a class="reference internal" href="#filepath-setting">“FilePath”</a>) does not work for these files any more. Application related files are:</p>
<blockquote>
<div><div class="line-block">
<div class="line">- &lt;application&gt;.app</div>
<div class="line">- &lt;application&gt;.crc</div>
<div class="line">- &lt;application&gt;.ret</div>
<div class="line">- &lt;application&gt;.frc</div>
<div class="line">- &lt;application&gt;.xml</div>
<div class="line">- &lt;application&gt;.core</div>
<div class="line">- &lt;application&gt;.trace.csv</div>
</div>
</div></blockquote>
</li>
<li><p>the new feature <a class="reference internal" href="#backup-restore">Backup&amp;Restore</a> is enabled.</p></li>
</ul>
</div>
<div class="section" id="id12">
<h4><span class="target" id="implicit-configuration">Implicit configuration</span><a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>If not configured otherwise the implicit file path configuration is as follows:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="c1">#if (PlcLogicPrefix==1)</span>
<span class="na">IecFilePath</span><span class="o">=</span><span class="s">$PlcLogic$</span>
<span class="na">PlaceholderFilePath</span><span class="o">=</span><span class="s">PlcLogic/, $PlcLogic$</span>
<span class="na">PlaceholderFilePath.1</span><span class="o">=</span><span class="s">$PlcLogic$/visu/, $visu$</span>
<span class="na">PlaceholderFilePath.1.VParent</span><span class="o">=</span><span class="s">$PlcLogic$</span>
<span class="na">PlaceholderFilePath.2</span><span class="o">=</span><span class="s">$PlcLogic$/trend/, $trend$</span>
<span class="na">PlaceholderFilePath.2.VParent</span><span class="o">=</span><span class="s">$PlcLogic$</span>
<span class="na">PlaceholderFilePath.3</span><span class="o">=</span><span class="s">$PlcLogic$/alarms/, $alarms$</span>
<span class="na">PlaceholderFilePath.3.VParent</span><span class="o">=</span><span class="s">$PlcLogic$</span>
<span class="na">PlaceholderFilePath.4</span><span class="o">=</span><span class="s">$PlcLogic$/ac_persistence/, $ac_persistence$</span>
<span class="na">PlaceholderFilePath.4.VParent</span><span class="o">=</span><span class="s">$PlcLogic$</span>
<span class="na">PlaceholderFilePath.5</span><span class="o">=</span><span class="s">TBF/, $TBF$</span>
<span class="na">PlaceholderFilePath.5.CreateOnWrite</span><span class="o">=</span><span class="s">1</span>
<span class="na">PlaceholderFilePath.6</span><span class="o">=</span><span class="s">$PlcLogic$/_cnc/, $_cnc$</span>
<span class="na">PlaceholderFilePath.6.VParent</span><span class="o">=</span><span class="s">$PlcLogic$</span>
<span class="c1">#else</span>
<span class="na">IecFilePath</span><span class="o">=</span>
<span class="na">PlaceholderFilePath</span><span class="o">=</span><span class="s">PlcLogic/, $PlcLogic$</span>
<span class="na">PlaceholderFilePath.1</span><span class="o">=</span><span class="s">visu/, $visu$</span>
<span class="na">PlaceholderFilePath.2</span><span class="o">=</span><span class="s">, $trend$</span>
<span class="na">PlaceholderFilePath.3</span><span class="o">=</span><span class="s">, $alarms$</span>
<span class="na">PlaceholderFilePath.4</span><span class="o">=</span><span class="s">, $ac_persistence$</span>
<span class="na">PlaceholderFilePath.5</span><span class="o">=</span><span class="s">TBF/, $TBF$</span>
<span class="na">PlaceholderFilePath.5.CreateOnWrite</span><span class="o">=</span><span class="s">1</span>
<span class="na">PlaceholderFilePath.6</span><span class="o">=</span><span class="s">_cnc/, $_cnc$</span>
<span class="c1">#endif</span>
</pre></div>
</div>
<p>An extra Placeholder “$IecFilePath$” is added with the path of “IecFilePath” in order to ensure access to IEC files via file transfer.
Prior to CODESYS V3.5 SP10 this placeholder was only available, when “IecFilePath” was set explicitely in the configuration file.</p>
<p>Individual known placeholders may be explicitly configured which override the single implicit setting such as:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[SysFile]</span>
<span class="na">PlaceholderFilePath</span><span class="o">=</span><span class="s">/mnt/slow_device/, $PlcLogic$</span>
<span class="na">PlaceholderFilePath.1</span><span class="o">=</span><span class="s">/mnt/fast_device/, $trend$</span>
<span class="na">PlaceholderFilePath.2</span><span class="o">=</span><span class="s">/mnt/secure_device/, $alarms$</span>
</pre></div>
</div>
<p>The above listed implicit “.VParent” setting will be preserved until not otherwise configured. E.g.:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">PlaceholderFilePath.3</span><span class="o">=</span><span class="s">/somewhere/, $_cnc$</span>
<span class="na">PlaceholderFilePath.3.VParent</span><span class="o">=</span>
</pre></div>
</div>
<p>In this case the placeholder “$_cnc$” is no longer found under “$PlcLogic$” but in the standard path only.</p>
<p>As shown in the examples the explicitly configired placeholders use their own consecutive numbering. There is no need to match with the numbering of the implicit configuration.</p>
</div>
</div>
</div>
<div class="section" id="id13">
<h2><a class="toc-backref" href="#id19">6.3.2.6. <span class="target" id="backup-restore">Backup&amp;Restore</span></a><a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h2>
<p>The new feature of V3.5 SP8 “Backup&amp;Restore of application related files” has the aim to backup and restore all files an application deals with, i.e., the application itself and all files it reads or writes, such as visu files, data base files, the retain variable file, all files accessed via IEC.</p>
<p>To bundle all these files a new folder and file structure is introduced:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[$PlcLogic$]
+ [&lt;applicaton&gt;]
  - &lt;application&gt;.app
  - &lt;application&gt;.crc
  - &lt;application&gt;.ret
  - &lt;application&gt;.frc
  - &lt;application&gt;.xml
  - &lt;application&gt;.core
  - &lt;application&gt;.trace.csv
- &lt;files created out of IEC&gt;
- IoConfig.par
+ [$trend$]
+ [$alarms$]
+ [$ac_persistence$]
+ [$visu$]
[$TBF$]
</pre></div>
</div>
<p>To switch to this new folder and file structure “PlcLogicPrefix=1” must be configured in the [SysFile] section (see <a class="reference internal" href="#plclogicprefix-setting">“PlcLogicPrefix”</a>).</p>
<p>With the simple mode implemented in V3.5 SP8 CODESYS fetches the contents of the “$PlcLogic$” folder and all its subfolders (either physical or virtual, except the redundant ones) via file transter from the RTS. The files are then put into an archive with a .tbf extension. TBF stands for Target Backup File. The restore of all the application related files works vice versa. Backup and restore of the complete runtime system will be provided in the future within CDS-45479.</p>
<p>A special treatment is done to retains which are written to a file by the RTS just before the backup information is given to CODESYS.</p>
<p>Datebase files may be not consistent when the RTS is not in STOP.</p>
<p>The folder “$TBF$” is considered to hold backup archives on the RTS file system and CODESYS looks there and displays these archives as a choice to restore from. This folder is not created by the RTS at startup but only when an archive is stored in there.</p>
<p>This chapter is just a short summary of this new feature. A separate documentation will be provided in the future with CDS-44812.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="CODESYSControlV3_SymbolicAccess.html" title="6.3.3. Symbolic IEC Variable Access"
             >next</a> |</li>
        <li class="right" >
          <a href="CODESYSControlV3_Scheduler/cmpscheduleembedded.html" title="6.3.1.3. CmpScheduleEmbedded"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">RuntimeSystemDocumentation V3.5.16.40</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >6. Tutorials / HowTos</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, 3S-Smart Software Solutions GmbH. This document is confidential. Unauthorized copying, disclosure or distribution of this document and the information contained herein is strictly forbidden.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>