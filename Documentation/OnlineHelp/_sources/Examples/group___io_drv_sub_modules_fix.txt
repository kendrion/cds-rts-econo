.. first line of composition.rst template

.. first line of group.rst template

.. _group___io_drv_sub_modules_fix:

==================
IoDrvSubModulesFix
==================

 :ref:`More... <group___io_drv_sub_modules_fix-details>`

Data Structures
---------------

- struct :ref:`IoDrvSubModulesFix <struct_io_drv_sub_modules_fix>`

Macros
------

- #define :ref:`STATICITF_DEF <group___io_drv_sub_modules_fix_1ga819be70ac9e7f8924fecb7b6db48cc4e>` static

- #define :ref:`MAX_CHANNELS <group___io_drv_sub_modules_fix_1gac69ee46f4a51ed14f0d68628c2dec71d>` 2

Functions
---------

- DLL_DECL int :ref:`ComponentEntry <group___io_drv_sub_modules_fix_1ga428e512ef9d385507218f5cb410ecf22>` (INIT_STRUCT * pInitStruct)

- IBase * :ref:`CreateInstance <group___io_drv_sub_modules_fix_1ga9f0dd7d920825aefbaa5a8b55d7be440>` (CLASSID cid, RTS_RESULT * pResult)

- RTS_RESULT :ref:`DeleteInstance <group___io_drv_sub_modules_fix_1ga943bdf9b0e320026633f0a53e0595660>` (IBase * pIBase)

- IMPLEMENT_ADDREF static IMPLEMENT_RELEASE void * :ref:`QueryInterface <group___io_drv_sub_modules_fix_1ga6abe2468348b8ceab360c498feae6c47>` (IBase * pBase, ITFID iid, RTS_RESULT * pResult)

- int :ref:`ExportFunctions <group___io_drv_sub_modules_fix_1ga9b0700711be53a466c6c8494343a465a>` (void)

- int :ref:`ImportFunctions <group___io_drv_sub_modules_fix_1ga87d62c8eb63af9f15a122c28448733bf>` (void)

- RTS_UI32 :ref:`CmpGetVersion <group___io_drv_sub_modules_fix_1gacf72d3e99274b04feca13b139859c539>` (void)

- RTS_RESULT :ref:`HookFunction <group___io_drv_sub_modules_fix_1ga0b2ad195d710768e5fa78879787cd805>` (RTS_UI32 ulHook, RTS_UINTPTR ulParam1, RTS_UINTPTR ulParam2)

- STATICITF RTS_HANDLE :ref:`IoDrvCreate <group___io_drv_sub_modules_fix_1ga955a283122475205369a536e4e9c1a2c>` (RTS_HANDLE hIIoDrv, CLASSID ClassId, int iId, RTS_RESULT * pResult)

- STATICITF RTS_RESULT :ref:`IoDrvDelete <group___io_drv_sub_modules_fix_1ga16a54322f1cf4117c60c1bd0ae62094f>` (RTS_HANDLE hIoDrv, RTS_HANDLE hIIoDrv)

- STATICITF RTS_RESULT :ref:`IoDrvGetInfo <group___io_drv_sub_modules_fix_1gad079aed8aec7626d0644099ce8749517>` (RTS_HANDLE hIoDrv, IoDrvInfo ** ppInfo)

- STATICITF RTS_RESULT :ref:`IoDrvUpdateConfiguration <group___io_drv_sub_modules_fix_1ga37c8e738e2668eb4afa7898af322b64b>` (RTS_HANDLE hIoDrv, IoConfigConnector * pConnectorList, int nCount)

- STATICITF RTS_RESULT :ref:`IoDrvUpdateMapping <group___io_drv_sub_modules_fix_1ga38f0838d1d2645a8c5d30ce7e6c95a10>` (RTS_HANDLE hIoDrv, IoConfigTaskMap * pTaskMapList, int nCount)

- STATICITF RTS_RESULT :ref:`IoDrvReadInputs <group___io_drv_sub_modules_fix_1ga9dcb990a4bb1c6b651310ee59c907903>` (RTS_HANDLE hIoDrv, IoConfigConnectorMap * pConnectorMapList, int nCount)

- STATICITF RTS_RESULT :ref:`IoDrvWriteOutputs <group___io_drv_sub_modules_fix_1ga871a938ca2411942388a68c8d31d5277>` (RTS_HANDLE hIoDrv, IoConfigConnectorMap * pConnectorMapList, int nCount)

- STATICITF RTS_RESULT :ref:`IoDrvStartBusCycle <group___io_drv_sub_modules_fix_1ga9dd6f7465b9a32eef3b0b99252237953>` (RTS_HANDLE hIoDrv, IoConfigConnector * pConnector)

- STATICITF RTS_RESULT :ref:`IoDrvScanModules <group___io_drv_sub_modules_fix_1ga120f3cb45599a8e3e11c44c181c323c1>` (RTS_HANDLE hIoDrv, IoConfigConnector * pConnector, IoConfigConnector ** ppConnectorList, int * pnCount)

- STATICITF RTS_RESULT :ref:`IoDrvGetModuleDiagnosis <group___io_drv_sub_modules_fix_1gae23f82c0f91a2778909976f2447d5b70>` (RTS_HANDLE hIoDrv, IoConfigConnector * pConnector)

- STATICITF RTS_RESULT :ref:`IoDrvIdentify <group___io_drv_sub_modules_fix_1ga367c1564031c56fe736c4b5149fc2260>` (RTS_HANDLE hIoDrv, IoConfigConnector * pConnector)

- STATICITF RTS_RESULT :ref:`IoDrvWatchdogTrigger <group___io_drv_sub_modules_fix_1ga07d32aead18738aa6a536e5edfc3e263>` (RTS_HANDLE hIoDrv, IoConfigConnector * pConnector)

.. _group___io_drv_sub_modules_fix-details:

Detailed Description
--------------------



Very simple example of an IO driver. This example consists of an device description and a corresponding IO driver component. The device of the device description can be added to a Control Win V3 soft plc device. It has a connector with one parameter, 2 input channels and 2 output channels. The corresponding IO driver component performs the basic functions of an IO driver:

- At startup, creating an instance of the driver and registering the instance at the IO manager

- At download, registering the instance at the connector and adding driver specific information to the channels

- At task start, updating the inputs

- At task end, updaing the outputs

More examples about IO drivers can be found in :ref:`IoDrvSimple <struct_io_drv_simple>` and :ref:`IoDrvTemplate <struct_io_drv_template>` .

Implements the IO driver interface

- IoDrvCreate

- IoDrvDelete

- IoDrvGetInfo

- IoDrvGetModuleDiagnosis

- IoDrvIdentify

- IoDrvReadInputs

- IoDrvScanModules

- IoDrvStartBusCycle

- IoDrvUpdateConfiguration

- IoDrvUpdateMapping

- IoDrvWatchdogTrigger

- IoDrvWriteOutputs

USAGE:

Install the device description to the CODESYS device repository and use "Add Device" command to add the device "IoDrvSubModulesFix" to your top level device (PLC). Add some channel mappings and use them in your IEC program. Compile the driver component and add to your runtime configuration. Download the application to test the driver.

This example driver uses static memory (s_ulyInputs and s_ulyOutputs) to simulate a physical input and output area. In IoDrvStartBusCycle, the example driver copies outputs to inputs, simulating outputs connected to inputs with a cable. In your real driver, adapt the code for reading inputs and writing outputs, and remove the copy-code in IoDrvStartBusCycle.

**Copyright:**

\(c) 2003-2016 3S-Smart Software Solutions

Macro Definition Documentation
------------------------------
.. _group___io_drv_sub_modules_fix_1ga819be70ac9e7f8924fecb7b6db48cc4e:

#define STATICITF_DEF static
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. _group___io_drv_sub_modules_fix_1gac69ee46f4a51ed14f0d68628c2dec71d:

#define MAX_CHANNELS 2
^^^^^^^^^^^^^^^^^^^^^^

Implementation of the IoDrv Interface

Function Documentation
----------------------

.. _group___io_drv_sub_modules_fix_1ga428e512ef9d385507218f5cb410ecf22:

DLL_DECL int ComponentEntry (INIT_STRUCT *pInitStruct)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Entry function of the component. Called at startup for each component. Used to exchange function pointers with the component manager.

**Parameters**

+---------+-------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| [in]    | pInitStruct | Pointer to structure with: pfExportFunctions OUT Pointer to function that exports component functions pfImportFunctions OUT Pointer to function that imports functions from other components pfGetVersion OUT Pointer to function to get component version pfRegisterAPI IN Pointer to component mangager function to register a api function pfGetAPI IN Pointer to component mangager function to get a api function pfCallHook IN Pointer to component mangager function to call a hook function |
+---------+-------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+

**Returns:**

ERR_OK if library could be initialized, else error code.

.. _group___io_drv_sub_modules_fix_1ga9f0dd7d920825aefbaa5a8b55d7be440:

static IBase* CreateInstance (CLASSID cid, RTS_RESULT *pResult)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. _group___io_drv_sub_modules_fix_1ga943bdf9b0e320026633f0a53e0595660:

static RTS_RESULT DeleteInstance (IBase *pIBase)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. _group___io_drv_sub_modules_fix_1ga6abe2468348b8ceab360c498feae6c47:

IMPLEMENT_ADDREF static IMPLEMENT_RELEASE void* QueryInterface (IBase *pBase, ITFID iid, RTS_RESULT *pResult)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. _group___io_drv_sub_modules_fix_1ga9b0700711be53a466c6c8494343a465a:

static int ExportFunctions (void)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Publish exported functions to the component manager, to make them available for other components. Use generated macro EXPORT_STMT.
**Returns:**

ERR_OK or error code in case of error

.. _group___io_drv_sub_modules_fix_1ga87d62c8eb63af9f15a122c28448733bf:

static int ImportFunctions (void)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Import function pointers from other components. Use generated macro IMPORT_STMT.
**Returns:**

ERR_OK or error code if function name could not be resolved

.. _group___io_drv_sub_modules_fix_1gacf72d3e99274b04feca13b139859c539:

static RTS_UI32 CmpGetVersion (void)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Return the version of our component.
**Returns:**

Version as defined in dep file

.. _group___io_drv_sub_modules_fix_1ga0b2ad195d710768e5fa78879787cd805:

static RTS_RESULT HookFunction (RTS_UI32 ulHook, RTS_UINTPTR ulParam1, RTS_UINTPTR ulParam2)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Example for a Hook function. Register and unregister driver instance here.

.. _group___io_drv_sub_modules_fix_1ga955a283122475205369a536e4e9c1a2c:

STATICITF RTS_HANDLE IoDrvCreate (RTS_HANDLE hIIoDrv, CLASSID ClassId, int iId, RTS_RESULT *pResult)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. _group___io_drv_sub_modules_fix_1ga16a54322f1cf4117c60c1bd0ae62094f:

STATICITF RTS_RESULT IoDrvDelete (RTS_HANDLE hIoDrv, RTS_HANDLE hIIoDrv)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. _group___io_drv_sub_modules_fix_1gad079aed8aec7626d0644099ce8749517:

STATICITF RTS_RESULT IoDrvGetInfo (RTS_HANDLE hIoDrv, IoDrvInfo **ppInfo)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. _group___io_drv_sub_modules_fix_1ga37c8e738e2668eb4afa7898af322b64b:

STATICITF RTS_RESULT IoDrvUpdateConfiguration (RTS_HANDLE hIoDrv, IoConfigConnector *pConnectorList, int nCount)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. _group___io_drv_sub_modules_fix_1ga38f0838d1d2645a8c5d30ce7e6c95a10:

STATICITF RTS_RESULT IoDrvUpdateMapping (RTS_HANDLE hIoDrv, IoConfigTaskMap *pTaskMapList, int nCount)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. _group___io_drv_sub_modules_fix_1ga9dcb990a4bb1c6b651310ee59c907903:

STATICITF RTS_RESULT IoDrvReadInputs (RTS_HANDLE hIoDrv, IoConfigConnectorMap *pConnectorMapList, int nCount)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. _group___io_drv_sub_modules_fix_1ga871a938ca2411942388a68c8d31d5277:

STATICITF RTS_RESULT IoDrvWriteOutputs (RTS_HANDLE hIoDrv, IoConfigConnectorMap *pConnectorMapList, int nCount)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. _group___io_drv_sub_modules_fix_1ga9dd6f7465b9a32eef3b0b99252237953:

STATICITF RTS_RESULT IoDrvStartBusCycle (RTS_HANDLE hIoDrv, IoConfigConnector *pConnector)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. _group___io_drv_sub_modules_fix_1ga120f3cb45599a8e3e11c44c181c323c1:

STATICITF RTS_RESULT IoDrvScanModules (RTS_HANDLE hIoDrv, IoConfigConnector *pConnector, IoConfigConnector **ppConnectorList, int *pnCount)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. _group___io_drv_sub_modules_fix_1gae23f82c0f91a2778909976f2447d5b70:

STATICITF RTS_RESULT IoDrvGetModuleDiagnosis (RTS_HANDLE hIoDrv, IoConfigConnector *pConnector)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. _group___io_drv_sub_modules_fix_1ga367c1564031c56fe736c4b5149fc2260:

STATICITF RTS_RESULT IoDrvIdentify (RTS_HANDLE hIoDrv, IoConfigConnector *pConnector)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. _group___io_drv_sub_modules_fix_1ga07d32aead18738aa6a536e5edfc3e263:

STATICITF RTS_RESULT IoDrvWatchdogTrigger (RTS_HANDLE hIoDrv, IoConfigConnector *pConnector)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. last line of group.rst template
.. last line of composition.rst template


