

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>5.3.14. License Management &#8212; RuntimeSystemDocumentation V3.5.16.40</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/theme.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5.3.15. Device User Management" href="ov_kernel_online_user_mgmt.html" />
    <link rel="prev" title="5.3.13. Exception Handling" href="ov_kernel_exception_handling.html" /> 
  </head><body>
	<div id="header">
		<a href="#" title="CODESYS" target="_top" id="logo"><img src="../_static/logo.png" width="134" height="130" alt=""></a>
		<a href="#" title="CODESYS Documentation" target="_top" id="logo-store"><img src="../_static/logo2.png" width="137" height="130" alt=""></a>
	</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="ov_kernel_online_user_mgmt.html" title="5.3.15. Device User Management"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="ov_kernel_exception_handling.html" title="5.3.13. Exception Handling"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">RuntimeSystemDocumentation V3.5.16.40</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >5. Architecture Manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="overview_kernel.html" accesskey="U">5.3. Overview of the Kernel Components and Main Functions</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h4>Previous topic</h4>
  <p class="topless"><a href="ov_kernel_exception_handling.html"
                        title="previous chapter">5.3.13. Exception Handling</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="ov_kernel_online_user_mgmt.html"
                        title="next chapter">5.3.15. Device User Management</a></p>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="license-management">
<span id="ov-kernel-license-mgmt"></span><h1>5.3.14. License Management<a class="headerlink" href="#license-management" title="Permalink to this headline">¶</a></h1>
<p>There are 2 different kind of licensing mechanisms in the runtime
system:</p>
<ul>
<li><div class="line-block">
<div class="line">Device type license:</div>
<div class="line">A device vendor can license single features for his device. So the
license is available on every device of the same type.</div>
</div>
</li>
<li><div class="line-block">
<div class="line">Single license:</div>
<div class="line">Single features or some libraries from the CODESYS store are
licensed per a single device. This is called single licensing.</div>
</div>
</li>
</ul>
<p>Both mechanisms are described now in detail.</p>
<div class="section" id="device-type-license">
<h2>5.3.14.1. Device type license<a class="headerlink" href="#device-type-license" title="Permalink to this headline">¶</a></h2>
<p>Extra license fees have to be paid for various features of CODESYS. The
use of this license is granted per device variant instead of one specific
device.</p>
<p>This chapter describes the protection of features that have been
licensed for a certain device type.</p>
<p>The check is performed by components which an OEM has already purchased
and is to prevent the customer of an OEM from using non-free components
on controllers of other manufacturers who have not purchased such
components. Furthermore, the license check is to make sure an end user
can only work with components which have actually been tested and
activated for the device in question.</p>
<p>A working license check needs a license file (3s.dat) which must be part
of the controller firmware. It defines which features are activated and
also contains the exact ID of the runtime system. So it can only be used
on the device in question. The license file is part of the runtime toolkit
delivery. It can be found in the folder “Configuration”. The file must
be made available in the directory of the runtime system.</p>
<p>For informations about how to map the file to different paths, see <a href="#id1"><span class="problematic" id="id2">FilePath_3SDat_</span></a>.</p>
<p>Every single controller type has its own ID consisting of vendor ID and
device ID. An OEM can freely define the device IDs for their controllers
but needs to register them at 3S to enable 3S to generate the license
files.</p>
<p>If the license file is missing or is incorrect, the non-free components
will either not run at all or run in a demo mode and the logger will
issue an error message. The visualization in demo mode displays a box on
the upper right of the screen that identifies the demo mode. The demo
mode of the field bus stacks are indicated with an orange icon (instead
of the green icon) in the device tree.</p>
<p>This works on components only from CODESYS V3.4 or higher. Devices with
an older version of CODESYS which work with non-free components of an
older version are not affected by this licensing mechanism</p>
<p>The actual license check takes place at runtime. If OEMs want to prevent
that customers using a non-licensed field bus when programming their
application, they can do so by making an entry in the device description
(see “allowonly” property of a Connector in device description file).</p>
</div>
<div class="section" id="oem-licensing">
<h2>5.3.14.2. OEM licensing<a class="headerlink" href="#oem-licensing" title="Permalink to this headline">¶</a></h2>
<p>We encourage our customers to let CODESYS GmbH maintain the device variants,
as it is much easier to upgrade specific devices to new versions. Additionally
it lowers the complexity of maintaining the variants on both sides.</p>
<p>But as this makes only sense to a specific number of variants, we allow our OEM
customers to maintain their own device variants if necessary. The sales aspect
of such a configuration needs to be cleared first.</p>
<p>Technically this means, that we provide only one delivery, which has a “mask”
set, so that the customer can change the device ID, and still use the same 3S.dat
licenses.</p>
<p>The device ID can then be changed by overloading the component SysTask. To overload
it, there is a template in the toolkit, named “SysTaskOEM”.</p>
<p>The drawback is, that the end-user can then use every license, which is enabled
in the 3S.dat file. But this is not always intended. To enable the OEM customer
to decide by himself which license he will enable for his users, there are two
possibilities:</p>
<ol class="arabic simple">
<li><p>Maintain different 3S.dat files. Then the firmware needs to place the active one
in the right path, or overload the mapping, if it was mapped like described in <a href="#id3"><span class="problematic" id="id4">FilePath_3SDat_</span></a>.</p></li>
<li><p>Mark the licenses as “dynamic”. This feature needs an adaptation, which needs
to be done in cooperation of a CODESYS Engineer. Alle licenses, marked as “dynamic”
are not directly usable. They need to be enabled by a component in the runtime system.</p></li>
</ol>
<p>The drawback of solution (2) is, that it is more complex to implement, and that the
user can’t use the demo mode of features, which are not enabled.</p>
</div>
<div class="section" id="single-license">
<h2>5.3.14.3. Single license<a class="headerlink" href="#single-license" title="Permalink to this headline">¶</a></h2>
<p>Single device licenses are managed different from device type licenses.
Here we use the technology of WIBU Systems called CodeMeter (see tutorial <code class="xref download docutils literal notranslate"><span class="pre">WIBU</span> <span class="pre">CodeMeter</span></code>
for additional information).</p>
<p>Licenses can be stored here on 2 different types of containers:</p>
<ol class="upperalpha">
<li><div class="line-block">
<div class="line">Dongle:</div>
<div class="line">A license dongle can be used and is available in different hardware
designs (USB, SD-card, CF-card)</div>
</div>
</li>
<li><div class="line-block">
<div class="line">SoftContainer:</div>
<div class="line">Here we need some hardware characteristics to bind the licenses.
Typical a hardware serial number is used here.</div>
<div class="line">Before you can install licenses on the device, you have to install
an empty container. For this you need a generated wbb-File. Every
WIBU license provider has to generate a wbb file. This is needed to
create an empty soft container during startup of the runtime
system.</div>
</div>
<blockquote>
<div><p>To install an empty container during startup of the runtime system
you have to register the wbb-File in CODESYSControl.cfg:</p>
<div class="line-block">
<div class="line">[CmpCodeMeter]</div>
<div class="line">InstallCmActContainer=1</div>
<div class="line">InitLicenseFile.&lt;n&gt;=&lt;Vendor&gt;License.wbb</div>
</div>
<div class="line-block">
<div class="line">&lt;n&gt; is here a continous rising number beginning with 0.</div>
<div class="line">&lt;Vendor&gt; is the license vendor name.</div>
</div>
<p>Steps to create a wbb file:</p>
<ol class="arabic simple">
<li><p>Install the newest WIBI CodeMeter DevKit</p></li>
<li><p>Install your Template wbb and wbc file (provided by WIBU):</p>
<ol class="loweralpha simple">
<li><p>Open CodeMeter Control Center</p></li>
<li><p>File / Import License: wbb</p></li>
<li><p>File / Import License: wbc</p></li>
</ol>
</li>
<li><p>Create your wbb file with the command line tool CmBoxPgm.exe:</p></li>
</ol>
<p>CmBoxPgm.exe /f&lt;Firmcode&gt; /p0 /ca /lif:&lt;Vendor&gt;License.wbb
/lpn:”LicenseLIF” /lpid:0001 /lfs:cus:CODESYSPlugIn</p>
<div class="line-block">
<div class="line">&lt;Firmcode&gt; Firmcode of the license provider</div>
<div class="line">&lt;Vendor&gt; is the license vendor name.</div>
</div>
</div></blockquote>
</li>
</ol>
<div class="section" id="windows-systems">
<h3>Windows systems<a class="headerlink" href="#windows-systems" title="Permalink to this headline">¶</a></h3>
<p>On Windows systems you have to install the so called WIBU CodeMeter
Runtime. This is automatically installed at CODESYS Control Win and
CODESYS Control RTE by the setup. Under CODESYS Control Linux SL the
runtime is installed too.</p>
</div>
<div class="section" id="embedded-systems">
<h3>Embedded systems<a class="headerlink" href="#embedded-systems" title="Permalink to this headline">¶</a></h3>
<p>On embedded systems you have to define the following macros for
different aspects:</p>
<ul>
<li><div class="line-block">
<div class="line">RTS_CODEMETER_EMBEDDED (Default):</div>
<div class="line">This compiler switch must be set on non Windows and Linux/x86
systems (without CodeMeter runtime). Accesses to dongles are
supported.</div>
</div>
</li>
<li><div class="line-block">
<div class="line">RTS_CODEMETER_SOFTLICENSING:</div>
<div class="line">With this compiler switch the support of SoftContainers is enabled.
To support this you have to implement the
SysTargetGetSerialNumber_Secure() interface function in your
SysTargetOEM component. Here the serial number of the device must
be returned to bind the soft licenses.</div>
</div>
</li>
</ul>
<p><em>Specialties for VxWorks:</em></p>
<p><strong>Under VxWorks only SoftContainers are supported at the moment!</strong> This
is because for the Dongle support you have to deactivate the file cache
globally for this partition, but in fact this means a deactivation of
the complete file cache which is not practicable.</p>
<p><em>Specialties for WindowsCE:</em></p>
<p><strong>Under WindowsCE only the Dongles are supported!</strong> This is because the
WIBU CodeMeter Runtime is not supported anymore for higher or equal
WindowsCE V7!</p>
<p>SoftContainers are only supported on platforms, on which the controller
vendor supports a safe and unique serial number! For this support please
contact CODESYS GmbH.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="ov_kernel_online_user_mgmt.html" title="5.3.15. Device User Management"
             >next</a> |</li>
        <li class="right" >
          <a href="ov_kernel_exception_handling.html" title="5.3.13. Exception Handling"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">RuntimeSystemDocumentation V3.5.16.40</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >5. Architecture Manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="overview_kernel.html" >5.3. Overview of the Kernel Components and Main Functions</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, 3S-Smart Software Solutions GmbH. This document is confidential. Unauthorized copying, disclosure or distribution of this document and the information contained herein is strictly forbidden.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>