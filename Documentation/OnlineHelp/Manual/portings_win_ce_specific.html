
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1.4.4. Windows CE Specific Information &#8212; RuntimeSystemOnlineHelp V3.5.14.0</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.5.14.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="RuntimeSystemOnlineHelp V3.5.14.0" href="../index.html" />
    <link rel="up" title="1.4. Portings" href="portings.html" />
    <link rel="next" title="1.5. Communication" href="communication.html" />
    <link rel="prev" title="1.4.3. VxWorks Specific Information" href="portings_vxworks_specific.html" /> 
  </head>
  <body role="document">
	<div id="header">
		<a href="#" title="CODESYS" target="_top" id="logo"><img src="../_static/logo.png" width="134" height="130" alt=""></a>
		<a href="#" title="CODESYS Documentation" target="_top" id="logo-store"><img src="../_static/logo2.png" width="137" height="130" alt=""></a>
	</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="communication.html" title="1.5. Communication"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="portings_vxworks_specific.html" title="1.4.3. VxWorks Specific Information"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">RuntimeSystemOnlineHelp V3.5.14.0</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >1. CODESYS Control V3 - Manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="portings.html" accesskey="U">1.4. Portings</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="portings_vxworks_specific.html"
                        title="previous chapter">1.4.3. VxWorks Specific Information</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="communication.html"
                        title="next chapter">1.5. Communication</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/Manual/portings_win_ce_specific.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="windows-ce-specific-information">
<span id="portings-win-ce-specific"></span><h1>1.4.4. Windows CE Specific Information<a class="headerlink" href="#windows-ce-specific-information" title="Permalink to this headline">¶</a></h1>
<p>Under Windows CE, we use the timer interrupt for the tick source of the
runtime scheduler. All PLC tasks are created as operating system threads
and are triggered by events from the runtime scheduler. The scheduling
of the tasks is done by the Windows CE scheduler.</p>
<p>Win CE specific settings in the runtime system configuration file
(*.cfg):</p>
<p>The <strong>communication cycle interval</strong> can be configured in order to
control CPU load:</p>
<div class="highlight-C"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">ComponentManager</span><span class="p">]</span>
<span class="n">WinCE</span><span class="p">.</span><span class="n">CommCycleInterval</span><span class="o">=</span><span class="mi">5</span>
</pre></div>
</div>
<p>The sleep duration after each comm cycle will be 5ms in this case. The
default before version 3.5 Sp4 was 1 ms which generated a relatively
high CPU load. Therefore the default value had been changed to 10 ms
from 3.5 Sp 4 on.</p>
<p>Under Windows CE it is not possible to handle relative paths. So the
default behavior of file transfer and access under Windows CE has
changed as from V3.4 SP4. From this version on, by default in the
device dialog there is no access to paths beyond the &#8220;working directory&#8221;.</p>
<p>For activating the old behavior (access to all files, e.g. also in the
root directory), the following setting can be added to the runtime
system configuration file:</p>
<div class="highlight-C"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">SysFile</span><span class="p">]</span>
<span class="n">WinCE</span><span class="p">.</span><span class="n">AllowRootAccess</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p>An explicit folder can be defined, to which the <strong>Target-Visualization
files</strong> (image files, textlists etc.) get redirected. By default, that
is when the setting is missing, they get stored in a subfolder &#8220;visu&#8221; of
the runtime system folder!</p>
<div class="highlight-C"><div class="highlight"><pre><span></span>[SysFile]
WinCE.VisuFilePath=\\Hard Disk\\SpecialFolder
</pre></div>
</div>
<p>Because CE cannot handle relative paths, the complete path of the desired
visu files folder must be specified in the setting!</p>
<p>Example: Setting „WinCE.VisuFilePath=\Hard Disk\SpecialFolder\SpecialVisuFolder&#8221;
effects that folder „SpecialVisuFolder&#8221; will be created as a subfolder
of „\Hard Disk\SpecialFolder&#8221; (in case it does not yet exist) and the
visualization files get stored there. The path &#8220;Hard Disk\SpecialFolder&#8221; must already exist!</p>
<p>If SRAM is used for retain handling with a specified address it might be
necessary to have the following additional setting.</p>
<div class="highlight-C"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">SysShm</span><span class="p">]</span>
<span class="n">WinCE</span><span class="p">.</span><span class="n">DisableMapPhysicalInVirtualAllocCopyEx</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p>As the Sysdriver uses the VirtualCopy function for mapping hardware
addresses to user program the behavior here depends on the CE image.
This setting has to be set on some devices where it is necessary to
have the &#8220;PAGE_PHYSICAL&#8221; flag in the call of &#8220;VirtualCopy&#8221; but not in
the call of &#8220;VirtualAllocCopyEx&#8221;. Otherwise it is possible that the
address that the Sysdriver returns to the user program is not correct
and retains do not work.</p>
<p>Per default, the CE runtime system tries to change the system memory
division to get more program memory and less storage memory. This
behavior can be suppressed by the setting</p>
<div class="highlight-C"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">SysGraphic</span><span class="p">]</span>
<span class="n">WinCE</span><span class="p">.</span><span class="n">DontChangeMemorySettings</span><span class="o">=</span><span class="mi">1</span>
</pre></div>
</div>
<p>So other applications will get more program memory.</p>
<p>Up to version 5, Windows CE processes have a 32 MB address space which
may be too small for big applications. To overcome this restriction
(only if the device has more than 32 MB physical RAM), the OEM can
change the memory layout of the device description (example for a 32 MB
area)</p>
<div class="highlight-C"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nl">ts</span><span class="p">:</span><span class="n">setting</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;minimal-area-size&quot;</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;integer&quot;</span> <span class="n">access</span><span class="o">=</span><span class="s">&quot;visible&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nl">ts</span><span class="p">:</span><span class="n">value</span><span class="o">&gt;</span><span class="mh">0x2000000</span><span class="o">&lt;/</span><span class="nl">ts</span><span class="p">:</span><span class="n">value</span><span class="o">&gt;</span> <span class="o">&lt;/</span><span class="nl">ts</span><span class="p">:</span><span class="n">setting</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nl">ts</span><span class="p">:</span><span class="n">setting</span> <span class="n">name</span><span class="o">=</span><span class="s">&quot;maximal-area-size&quot;</span> <span class="n">type</span><span class="o">=</span><span class="s">&quot;integer&quot;</span> <span class="n">access</span><span class="o">=</span><span class="s">&quot;visible&quot;</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nl">ts</span><span class="p">:</span><span class="n">value</span><span class="o">&gt;</span><span class="mh">0x2000000</span><span class="o">&lt;/</span><span class="nl">ts</span><span class="p">:</span><span class="n">value</span><span class="o">&gt;</span> <span class="o">&lt;/</span><span class="nl">ts</span><span class="p">:</span><span class="n">setting</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>and the runtime configuration file</p>
<div class="highlight-C"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">SysMem</span><span class="p">]</span>
<span class="n">WinCE</span><span class="p">.</span><span class="n">CE5BigAreaSize</span><span class="o">=</span><span class="mh">0x2000000</span>
</pre></div>
</div>
<p>As from V3.5 there is a new source file <strong>SysDrv3SCECustom.cpp</strong> for
<strong>customer specific adaptations</strong>. A new project file
SysDrv3SCECustom.vcproj for CE6 and SysDrv3SCE7Custom.vcproj for CE7 is
available to build the dll by including the SysDrv3SCE.obj and the
customer specific source file.</p>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="communication.html" title="1.5. Communication"
             >next</a> |</li>
        <li class="right" >
          <a href="portings_vxworks_specific.html" title="1.4.3. VxWorks Specific Information"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">RuntimeSystemOnlineHelp V3.5.14.0</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >1. CODESYS Control V3 - Manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="portings.html" >1.4. Portings</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, 3S-Smart Software Solutions GmbH.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.
    </div>
  </body>
</html>