

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>5.2.10. Embedded runtime &#8212; RuntimeSystemDocumentation V3.5.16.40</title>
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/theme.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5.3. Overview of the Kernel Components and Main Functions" href="overview_kernel.html" />
    <link rel="prev" title="5.2.9. Files on the Target System" href="arch_files_on_target.html" /> 
  </head><body>
	<div id="header">
		<a href="#" title="CODESYS" target="_top" id="logo"><img src="../_static/logo.png" width="134" height="130" alt=""></a>
		<a href="#" title="CODESYS Documentation" target="_top" id="logo-store"><img src="../_static/logo2.png" width="137" height="130" alt=""></a>
	</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="overview_kernel.html" title="5.3. Overview of the Kernel Components and Main Functions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="arch_files_on_target.html" title="5.2.9. Files on the Target System"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">RuntimeSystemDocumentation V3.5.16.40</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >5. Architecture Manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="architecture.html" accesskey="U">5.2. Architecture</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
  <h4>Previous topic</h4>
  <p class="topless"><a href="arch_files_on_target.html"
                        title="previous chapter">5.2.9. Files on the Target System</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="overview_kernel.html"
                        title="next chapter">5.3. Overview of the Kernel Components and Main Functions</a></p>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="embedded-runtime">
<span id="arch-embedded-runtime"></span><h1>5.2.10. Embedded runtime<a class="headerlink" href="#embedded-runtime" title="Permalink to this headline">¶</a></h1>
<p>In general the whole runtime is very scalable. By disabling features,
you can scale it down to very small systems running on drives, mobile
machine controllers, etc. So generally spoken, there is no difference
between an “embedded” or “full” runtime. But as the requirements for
those small systems are a bit different, there are a few components that
have an alternative implementation, which fits better for embedded
systems.</p>
<p>Those components usually have the Postfix “Embedded”. The following
table describes the most central and most important special components
and their specialties.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 8%" />
<col style="width: 10%" />
<col style="width: 82%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Standard Component</p></th>
<th class="head"><p>Embedded alternative</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CmpApp</p></td>
<td><p>CmpAppEmbedded</p></td>
<td><p>Supports only one application, but therefore has an option to run from flash optionally. Note, that the download format is different.</p></td>
</tr>
<tr class="row-odd"><td><p>CmpAppBP</p></td>
<td><p>CmpAppBPEmbedded</p></td>
<td><p>Supports only basic breakpoints and some rudimentary conditional breakpoints. Execution Points, Flow Control and complex conditional breakpoints are not supported.</p></td>
</tr>
<tr class="row-even"><td><p>CmpEventMgr</p></td>
<td><p>CmpEventMgrEmbedded</p></td>
<td><p>Supports no IEC interface and has a datamanagement, that is optimized for memory consumption. The handling is optimal if there are only a small number of listeners.</p></td>
</tr>
<tr class="row-odd"><td><p>CmpChannelMgr</p></td>
<td><p>CmpChannelMgrEmbedded</p></td>
<td><p>Those two components have to be selected in combination always. They support only one channel and are occupying less space in RAM and FLASH.</p></td>
</tr>
<tr class="row-even"><td><p>CmpChannelServer</p></td>
<td><p>CmpChannelServerEmbedded</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>CmpSettings</p></td>
<td><p>CmpSettingsEmbedded</p></td>
<td><p>Supports no settings file (ini file format), but therefore a static list of settings in memory. Those settings can be written and read and if the OEM customer likes to store them on a persistent media, this is possible.</p></td>
</tr>
<tr class="row-even"><td><p>CmpRouter</p></td>
<td><p>CmpRouterEmbedded</p></td>
<td><p>Supports only one main-net (= one block driver) and no routing between networks.</p></td>
</tr>
<tr class="row-odd"><td><p>CmpSchedule</p></td>
<td><p>CmpScheduleEmbedded</p></td>
<td><p>Executes all IEC tasks in one super loop in the background. No preemption is supported.</p></td>
</tr>
<tr class="row-even"><td><p>CmpSchedule</p></td>
<td><p>CmpScheduleTimer</p></td>
<td><p>Similar to CmpScheduleEmbedded, but executes cyclic IEC tasks in the context of system timers. Those system timers may be based on hardware timers directly (beware of interrupt locks!) or on an embedded operating system.</p></td>
</tr>
<tr class="row-odd"><td><p>CmpIoMgr</p></td>
<td><p>CmpIoMgrEmbedded</p></td>
<td><p>Supports the same main features as the IoMgr, but is optimized to run on systems w/o tasks and w/o semaphores.</p></td>
</tr>
<tr class="row-even"><td><p>SysFile</p></td>
<td><p>SysFileFlash</p></td>
<td><p>A very simple file implementation which works on memory mapped files in flash. It uses SysFlash to write data to flash, but the flash has to be memory mapped.</p></td>
</tr>
</tbody>
</table>
<div class="section" id="compact-download-format">
<h2>5.2.10.1. Compact download format<a class="headerlink" href="#compact-download-format" title="Permalink to this headline">¶</a></h2>
<p>If an embedded runtime is using CmpAppEmbedded, instead of CmpApp, it
also uses a different download format implicitly. This format is called
“compact download”.</p>
<p>The following settings in device description shall be used:
compact_download, constants-in-own-segment, code-segment-header-size.</p>
<p>Instead of using a flexible but complex tagged format, the compact
download consists of one binary file, which can be directly downloaded
to flash, and even be executed from there. The binary file starts with a
header, which contains the most important information directly and
points to more advanced sections within the binary.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Segment</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CodeHeader:</p>
<p>RTS_UI32 ulHeaderTag;</p>
<p>RTS_UI32 ulHeaderVersion;</p>
<p>RTS_UI32 ulHeaderSize;</p>
<p>RTS_UI32 ulTotalSize;</p>
<p>RTS_UI32 ulDeviceType;</p>
<p>RTS_UI32 ulDeviceId;</p>
<p>RTS_UI32 ulDeviceVersion;</p>
<p>RTS_UI32 ulFlags;</p>
<p>RTS_UI32 ulCompilerVersion;</p>
<p>RTS_UI32 ulCodeAreaSize;</p>
<p>RTS_UI16 usCodeAreaIndex;</p>
<p>RTS_UI16 usCodeAreaFlags;</p>
<p>RTS_UI32 ulOffsetCode;</p>
<p>RTS_UI32 ulSizeCode;</p>
<p>RTS_UI32 ulOffsetApplicationInfo</p>
<p>RTS_UI32 ulSizeApplicationInfo;</p>
<p>RTS_UI32 ulOffsetAreaTable</p>
<p>RTS_UI32 ulSizeAreaTable;</p>
<p>RTS_UI32 ulOffsetFunctionTable;</p>
<p>RTS_UI32 ulSizeFunctionTable;</p>
<p>RTS_UI32 ulOffsetExternalFunctionTable;</p>
<p>RTS_UI32 ulSizeExternalFunctionTable;</p>
<p>RTS_UI32 lOffsetRegisterIecFunctionTable;</p>
<p>RTS_UI32 ulSizeRegisterIecFunctionTable;</p>
<p>RTS_UI32 ulOffsetSourceCode;</p>
<p>RTS_UI32 ulSizeSourceCode;</p>
<p>RTS_UI32 ulCrc;</p>
</td>
<td><p>Header of the stream:</p>
<p>HeaderTag=0x1234ABCD</p>
<p>HeaderVersion=0x00000001</p>
<p>HeaderSize=104</p>
<p>Total size of header including all segments</p>
<p>Device type of the selected device</p>
<p>DeviceID of the selected device</p>
<p>Device version of the selected device</p>
<p>Download Flags</p>
<p>Compiler version of used CODESYS version</p>
<p>Code area size</p>
<p>Code area index</p>
<p>Code area flags</p>
<p>Offset in bytes, where the code segment begins</p>
<p>Size in bytes of the code segment</p>
<p>Offset in bytes, where the application info segment begins</p>
<p>Size in bytes of the application info segment</p>
<p>Offset in bytes, where the area table segment begins</p>
<p>Size in bytes of the area table segment</p>
<div class="line-block">
<div class="line">Offset in bytes, where the function table segment begins, Here the link function are specified:</div>
<div class="line">- CodeInit</div>
<div class="line">- GlobalInit</div>
<div class="line">- GlobalExit</div>
<div class="line">- Reloc</div>
<div class="line">- DownloadCode</div>
<div class="line">- TargetInfo</div>
</div>
<p>Size in bytes of the function table segment</p>
<p>Offset in bytes, where the external function table segment begins to link c functions against iec code</p>
<p>Size in bytes of the external function table segment</p>
<p>Offset in bytes, where the iec function table segment begins to link iec functions against the runtime system</p>
<p>Size in bytes of the external function table segment</p>
<p>Offset in bytes, where the optional sourcecode segment begins</p>
<p>Size in bytes of the optional sourcecode segment</p>
<p>RC32 of the complete download stream including the header with ulCRC written to 0!</p>
</td>
</tr>
<tr class="row-odd"><td><p>Code segment</p></td>
<td><p>Code POUs</p></td>
</tr>
<tr class="row-even"><td><p>ApplicationInfo segment:</p>
<p>All names are transmitted 4 byte aligned:</p>
<div class="line-block">
<div class="line">Project name (ASCII string)</div>
<div class="line">Author (ASCII string)</div>
<div class="line">Version (ASCII string)</div>
<div class="line">Description (ASCII string)</div>
<div class="line">Profile (ASCII string)</div>
<div class="line">Date of last change (DATE_AND_TIME)</div>
</div>
</td>
<td><p>Application info</p></td>
</tr>
<tr class="row-odd"><td><p>Area segment:</p>
<p>List of AREA_INFO</p>
</td>
<td><p>Table of all used areas</p></td>
</tr>
<tr class="row-even"><td><p>Function table:</p>
<ol class="arabic simple">
<li><p>pfCodeInit</p></li>
<li><p>pfGlobalInit</p></li>
<li><p>pfGlobalExit</p></li>
<li><p>pfReloc</p></li>
<li><p>pfDownloadCode</p></li>
<li><p>pfTargetInfo</p></li>
</ol>
</td>
<td><p>Function table to link to runtime</p></td>
</tr>
<tr class="row-odd"><td><p>External Function table:</p>
<p>List of EXT_REF_INFO (4 Byte aligned for the next entry!)</p>
</td>
<td><p>Table of external references</p></td>
</tr>
<tr class="row-even"><td><p>IEC Function table:</p>
<p>List of FUNCTION_INFO with following name of the IEC function at the end (4 Byte aligned for the next entry!)</p>
</td>
<td><p>Table of IEC functions that can be called from C</p></td>
</tr>
<tr class="row-odd"><td><p>Source code segment:</p>
<p>Actually not used</p>
</td>
<td><p>Optional source code segment for the source code of the used project</p></td>
</tr>
<tr class="row-even"><td><p>CRC</p></td>
<td><p>CRC over the complete download stream</p></td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="overview_kernel.html" title="5.3. Overview of the Kernel Components and Main Functions"
             >next</a> |</li>
        <li class="right" >
          <a href="arch_files_on_target.html" title="5.2.9. Files on the Target System"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">RuntimeSystemDocumentation V3.5.16.40</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >5. Architecture Manual</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="architecture.html" >5.2. Architecture</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, 3S-Smart Software Solutions GmbH. This document is confidential. Unauthorized copying, disclosure or distribution of this document and the information contained herein is strictly forbidden.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>